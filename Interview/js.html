<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JS面试题 | 个人博客</title>
    <meta name="description" content="个人工作中整理的知识库">
    
    
    <link rel="preload" href="/assets/css/0.styles.c9120bc4.css" as="style"><link rel="preload" href="/assets/js/app.28316916.js" as="script"><link rel="preload" href="/assets/js/2.2f6f10e7.js" as="script"><link rel="prefetch" href="/assets/js/10.dcf85d9a.js"><link rel="prefetch" href="/assets/js/11.b5e94e03.js"><link rel="prefetch" href="/assets/js/12.20a8dee0.js"><link rel="prefetch" href="/assets/js/13.219090b4.js"><link rel="prefetch" href="/assets/js/14.7fd9e762.js"><link rel="prefetch" href="/assets/js/15.a8ab8c62.js"><link rel="prefetch" href="/assets/js/16.d1e9135e.js"><link rel="prefetch" href="/assets/js/17.92b7f34d.js"><link rel="prefetch" href="/assets/js/18.aff41a9a.js"><link rel="prefetch" href="/assets/js/19.329c50b6.js"><link rel="prefetch" href="/assets/js/20.03ac4d5b.js"><link rel="prefetch" href="/assets/js/21.b6061670.js"><link rel="prefetch" href="/assets/js/22.72d35ede.js"><link rel="prefetch" href="/assets/js/3.1b802084.js"><link rel="prefetch" href="/assets/js/4.3df0f09f.js"><link rel="prefetch" href="/assets/js/5.2c5508de.js"><link rel="prefetch" href="/assets/js/6.4b5e7ee3.js"><link rel="prefetch" href="/assets/js/7.42f5b3e0.js"><link rel="prefetch" href="/assets/js/8.4c2a8588.js"><link rel="prefetch" href="/assets/js/9.6bc43511.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c9120bc4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">个人博客</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/Front/" class="nav-link">前端</a></div><div class="nav-item"><a href="/Interview/" class="nav-link router-link-active">面试</a></div><div class="nav-item"><a href="/Java/" class="nav-link">Java</a></div><div class="nav-item"><a href="/WebSecurity/" class="nav-link">网络安全</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/Front/" class="nav-link">前端</a></div><div class="nav-item"><a href="/Interview/" class="nav-link router-link-active">面试</a></div><div class="nav-item"><a href="/Java/" class="nav-link">Java</a></div><div class="nav-item"><a href="/WebSecurity/" class="nav-link">网络安全</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Interview/" aria-current="page" class="sidebar-link">页面说明</a></li><li><a href="/Interview/js.html" aria-current="page" class="active sidebar-link">JS面试题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Interview/js.html#请分析以下代码执行结果-parseint问题-百度面试题" class="sidebar-link">请分析以下代码执行结果----parseInt问题(百度面试题)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#arguments0-问题（百度）" class="sidebar-link">&quot;arguments0&quot;问题（百度）</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#请写出-inner-的实际高度。" class="sidebar-link">请写出 inner 的实际高度。</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#函数返回表达式，请写出以下代码执行结果。（快手）" class="sidebar-link">函数返回表达式，请写出以下代码执行结果。（快手）</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#this指向问题，自执行函数中this问题-快手" class="sidebar-link">this指向问题，自执行函数中this问题(快手)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#循环绑定click点击事件-腾讯面试题" class="sidebar-link">循环绑定click点击事件(腾讯面试题)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#函数的arguments为什么不是数组？如何转化成数组？" class="sidebar-link">函数的arguments为什么不是数组？如何转化成数组？</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#你理解的闭包作用是什么-优缺点-乐视" class="sidebar-link">你理解的闭包作用是什么? 优缺点? (乐视)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#数组去重问题" class="sidebar-link">数组去重问题</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#对象中this指向-用友面试题" class="sidebar-link">对象中this指向(用友面试题)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#this指向问题-阿里" class="sidebar-link">this指向问题(阿里)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#原型链-腾讯面试题" class="sidebar-link">原型链(腾讯面试题)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#原型链问题-京东" class="sidebar-link">原型链问题(京东)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#阿里超经典面试题-比较难" class="sidebar-link">阿里超经典面试题 (比较难)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#闭包对象问题-滴滴-很难" class="sidebar-link">闭包对象问题(滴滴 很难)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#document-parentnode和document-parentnode的区别？-腾讯" class="sidebar-link">document.parentNode和document.parentnode的区别？(腾讯)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#怎么规避多人开发函数重名的问题-百度搜索" class="sidebar-link">怎么规避多人开发函数重名的问题?(百度搜索)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#条件语句中定义变量-腾讯" class="sidebar-link">条件语句中定义变量(腾讯)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#全局及局部作用域变量提升" class="sidebar-link">全局及局部作用域变量提升</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#条件判断中的函数声明提升-360面试题" class="sidebar-link">条件判断中的函数声明提升(360面试题)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#作用域和值类型引用类型的传递" class="sidebar-link">作用域和值类型引用类型的传递:</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#js变量提升问题" class="sidebar-link">JS变量提升问题</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#es6中class和普通构造函数有何区别？" class="sidebar-link">ES6中class和普通构造函数有何区别？</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#形参及实参问题" class="sidebar-link">形参及实参问题</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#严格模式和非严格模式区别" class="sidebar-link">严格模式和非严格模式区别</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#逻辑与-和逻辑或" class="sidebar-link">逻辑与&amp;&amp;和逻辑或||</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#封装函数进行字符串驼峰命名" class="sidebar-link">封装函数进行字符串驼峰命名</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#冒泡排序" class="sidebar-link">冒泡排序</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#去除数组中重复性的数据" class="sidebar-link">去除数组中重复性的数据:</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#js综合面试题" class="sidebar-link">js综合面试题</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#函数防抖和函数节流" class="sidebar-link">函数防抖和函数节流</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#node-js的事件轮询机制" class="sidebar-link">node.js的事件轮询机制</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#node-js的event-loop中promise-then-和process-nexttick执行顺序问题" class="sidebar-link">Node.js的Event Loop中promise.then()和process.nextTick执行顺序问题</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#闭包" class="sidebar-link">闭包</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#变量和函数的私有作用域的上级跟此函数在哪执行无关，只跟它在哪创建有关？" class="sidebar-link">变量和函数的私有作用域的上级跟此函数在哪执行无关，只跟它在哪创建有关？</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#this关键字的机制和定义" class="sidebar-link">this关键字的机制和定义</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#对象中方法的闭包及this指向问题" class="sidebar-link">对象中方法的闭包及this指向问题</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#数组作为参数传入" class="sidebar-link">数组作为参数传入</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#i-问题" class="sidebar-link">i++问题</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#变量提升-预处理-执行上下文" class="sidebar-link">变量提升/预处理 &amp;&amp; 执行上下文</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#宏任务-微任务" class="sidebar-link">宏任务 &amp;&amp; 微任务</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#promise-resolve-执行顺序" class="sidebar-link">Promise.resolve()执行顺序</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#红绿灯问题" class="sidebar-link">红绿灯问题</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#js中浅拷贝的手段有哪些？" class="sidebar-link">JS中浅拷贝的手段有哪些？</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#深拷贝" class="sidebar-link">深拷贝</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#递归遍历所有dom节点" class="sidebar-link">递归遍历所有DOM节点</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#实例对象和构造函数的关系" class="sidebar-link">实例对象和构造函数的关系</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#javascript如何实现面向对象中的继承？-百度移动" class="sidebar-link">JavaScript如何实现面向对象中的继承？(百度移动)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#函数声明及函数表达式" class="sidebar-link">函数声明及函数表达式</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#为什么在javascript中0-1-0-2不等于0-3？" class="sidebar-link">为什么在JavaScript中0.1+0.2不等于0.3？</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#js-中null-undefined区别" class="sidebar-link">js 中null,undefined区别</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#懒加载和预加载" class="sidebar-link">懒加载和预加载</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#symbol属性" class="sidebar-link">Symbol属性</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#new-操作符做了哪些事？" class="sidebar-link">new 操作符做了哪些事？</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#将函数当构造器执行做了哪些事？" class="sidebar-link">将函数当构造器执行做了哪些事？</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#箭头函数的this指向问题-实现私有变量" class="sidebar-link">箭头函数的this指向问题(实现私有变量)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#不使用new运算符，尽可能找到获得对象的方法。" class="sidebar-link">不使用new运算符，尽可能找到获得对象的方法。</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#遍历html节点-输出标签名字" class="sidebar-link">遍历HTML节点,输出标签名字</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#for-in用于对象，for-of用于数组，那么有没有方法让对象可以使用for-of语句-symbol-iterator" class="sidebar-link">for in用于对象，for of用于数组，那么有没有方法让对象可以使用for of语句[Symbol.iterator]?</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#为什么javascript里面typeof-null-的值是-object-？" class="sidebar-link">为什么JavaScript里面typeof(null)的值是&quot;object&quot;？</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#instanceof能否判断基本数据类型？" class="sidebar-link">instanceof能否判断基本数据类型？</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#能不能手动实现instanceof的功能？" class="sidebar-link">能不能手动实现instanceof的功能？</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#和-有什么区别？" class="sidebar-link">'==' 和 '===' 有什么区别？</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#对象转原始类型是根据什么流程运行的" class="sidebar-link">对象转原始类型是根据什么流程运行的?</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#如何让if-a-1-a-2-条件成立？" class="sidebar-link">如何让if(a == 1 &amp;&amp; a == 2)条件成立？</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#不同类型比较的规则" class="sidebar-link">==不同类型比较的规则</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#object-is和-的区别？" class="sidebar-link">Object.is和===的区别？</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#为啥1-tostring-、-tostring-会报错" class="sidebar-link">为啥1.toString 、 {}.toString()会报错?</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#script标签异步引入外部资源，defer和async有啥区别？" class="sidebar-link">script标签异步引入外部资源，defer和async有啥区别？</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#mouseover-mouseout和mouseenter-mouseleave的区别" class="sidebar-link">mouseover mouseout和mouseenter mouseleave的区别</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#js中数组扁平化" class="sidebar-link">JS中数组扁平化</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#请用js实现ajax并发请求控制-字节跳动" class="sidebar-link">请用JS实现Ajax并发请求控制(字节跳动)</a></li><li class="sidebar-sub-header"><a href="/Interview/js.html#js实现将数字转成千分位的方法小结【5种方式】" class="sidebar-link">JS实现将数字转成千分位的方法小结【5种方式】</a></li></ul></li><li><a href="/Interview/html.html" class="sidebar-link">HTML相关</a></li><li><a href="/Interview/css.html" class="sidebar-link">CSS面试题</a></li><li><a href="/Interview/coreCode.html" class="sidebar-link">手写源码系列</a></li><li><a href="/Interview/browser.html" class="sidebar-link">浏览器相关</a></li><li><a href="/Interview/frame.html" class="sidebar-link">前端框架相关</a></li><li><a href="/Interview/miApp.html" class="sidebar-link">小程序公众号</a></li><li><a href="/Interview/ts.html" class="sidebar-link">TS面试题</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="js面试题"><a href="#js面试题" class="header-anchor">#</a> JS面试题</h1> <h2 id="请分析以下代码执行结果-parseint问题-百度面试题"><a href="#请分析以下代码执行结果-parseint问题-百度面试题" class="header-anchor">#</a> 请分析以下代码执行结果----parseInt问题(百度面试题)</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'10'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>parseInt<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [1, NaN, 2]</span>
</code></pre></div><p><a href="https://blog.csdn.net/weixin_44135121/article/details/88050214" target="_blank" rel="noopener noreferrer">解析<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="tip custom-block"><p class="custom-block-title">原因分析</p> <ol><li>map函数
将数组的每个元素传递给指定的函数处理，并返回处理后的数组，所以 ['1','2','3'].map(parseInt) 就是将字符串1，2，3作为元素；0，1，2作为下标分别调用 parseInt 函数。即分别求出 parseInt('1',0), parseInt('2',1), parseInt('3',2)的结果。</li> <li>parseInt函数（<font color="red">重点</font>）
概念：以第二个参数为基数来解析第一个参数字符串，通常用来做十进制的向上取整（省略小数）<br>
特点：接收两个参数parseInt(string,radix)<br>
string：字母（大小写均可）、数组、特殊字符（不可放在开头,特殊字符及特殊字符后面的内容不做解析）的任意字符串</li></ol></div> <div class="tip custom-block"><p class="custom-block-title">MDN</p> <p>MDN文档中指明 parseInt 第二个参数是一个2到36之间的整数值，用于指定转换中采用的基数。如果省略该参数或其值为0，则数字将以10为基础来解析。如果该参数小于2或者大于36，则 parseInt 返回 NaN。此外，转换失败也会返回 NaN</p></div> <div class="tip custom-block"><p class="custom-block-title">规则</p> <p>radix：解析字符串的基数，基数规则如下：</p> <ol><li>区间范围介于2~36之间；</li> <li>当参数为 0，parseInt() 会根据十进制来解析；</li> <li>如果忽略该参数，默认的基数规则：<br>
*. 如果 string 以 &quot;0x&quot; 开头，parseInt() 会把 string 的其余部分解析为十六进制的整数；parseInt(&quot;0xf&quot;)   //15 <br>
*. 如果 string 以 0 开头，其后的字符解析为八进制或十六进制的数字；parseInt(&quot;08&quot;)   //8<br>
*. 如果 string 以 1 ~ 9 的数字开头，parseInt() 将把它解析为十进制的整数；parseInt(&quot;88.99f&quot;)   //88<br>
*. 只有字符串中的第一个数字会被返回。parseInt(&quot;10.33&quot;)   //返回10；<br>
*. 开头和结尾的空格是允许的。parseInt(&quot; 69 10 &quot;)   //返回69<br>
*. 如果字符串的第一个字符不能被转换为数字，返回 NaN。parseInt(&quot;f&quot;)  //返回NaN  而parseInt(&quot;f&quot;，16)  //返回15<br>
3.再来分析一下结果
['1','2','10'].map(parseInt)即
parseInt('1',0);radix 为 0，parseInt() 会根据十进制来解析，所以结果为 1；
parseInt('2',1);radix 为 1，超出区间范围，所以结果为 NaN；
parseInt('10',2);radix 为 2，用2进制来解析，所以结果为 2</li></ol></div> <hr> <h2 id="arguments0-问题（百度）"><a href="#arguments0-问题（百度）" class="header-anchor">#</a> &quot;arguments<a href>0</a>&quot;问题（百度）</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> number <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">number</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token function-variable function">show</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>number <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//输出10 undefined</span>
<span class="token comment">//原因：函数的执行环境只与它在哪声明有关，与它在哪执行无关，所以fn()执行时，this指向window，输出10；</span>
<span class="token comment">//而arguments[0]指向fn，但是arguments是一个对象，所以arguments中this指向arguments，因此输出undefined</span>

<span class="token comment">/*        相应变体          */</span>
<span class="token keyword">var</span> length <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">length</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token function-variable function">methods</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">methods</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 10 2</span>
<span class="token comment">/*
第一个 fn  this指向window   输出10
第二个 arguments[0]() 可以理解为arguments.0() [只是方便理解] ，
            即argument对象调用fn函数，所以this指向arguments对象
arguments = {
  0:fn,    //function fn(){console.log(this.length);}
  1:第二个参数 1，
  length:2
}
*/</span>


<span class="token keyword">var</span> len <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">len</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token function-variable function">method</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">len</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token function-variable function">method</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

obj2<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span>obj1<span class="token punctuation">.</span>method<span class="token punctuation">,</span>obj2<span class="token punctuation">.</span>method<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 10 undefined</span>
<span class="token comment">/*
第一个 fn  this指向window   输出10
第二个 arguments[0]()    this指向arguments
 arguments = {
  0:obj1.method,   //function(){console.log(this.len);}
  1:obj2.method,
  length:2
}
arguments没有len属性，所以为undefined
*/</span>
</code></pre></div><hr> <h2 id="请写出-inner-的实际高度。"><a href="#请写出-inner-的实际高度。" class="header-anchor">#</a> 请写出 inner 的实际高度。</h2> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">.outer</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.inner</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
    <span class="token property">padding-top</span><span class="token punctuation">:</span> 20%<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>outer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>inner<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><a href="https://blog.csdn.net/sunshine1990916/article/details/80938294" target="_blank" rel="noopener noreferrer">CSS中的一些属性百分比值，相对于谁计算？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="tip custom-block"><p class="custom-block-title">解析</p> <ol><li>inner整体高度padding-box为100px, content-box内容区高度为60px;</li> <li><font color="red">padding-top,right,buttom,left百分比值; margin-top,right,buttom,left百分比值;都是相对于父元素的宽度的值计算，而不是相对于高度来计算的</font></li></ol></div> <hr> <h2 id="函数返回表达式，请写出以下代码执行结果。（快手）"><a href="#函数返回表达式，请写出以下代码执行结果。（快手）" class="header-anchor">#</a> 函数返回表达式，请写出以下代码执行结果。（快手）</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
  y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
  z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>x <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
y <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>x <span class="token operator">=</span> x <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
z <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// x:1 y:4 z:4</span>
<span class="token comment">//函数覆盖，函数执行内部形参不影响外部，函数return x = 3的表达式相当于x = 3;return x；</span>
</code></pre></div><hr> <h2 id="this指向问题，自执行函数中this问题-快手"><a href="#this指向问题，自执行函数中this问题-快手" class="header-anchor">#</a> this指向问题，自执行函数中this问题(快手)</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> myObject <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">num</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token function-variable function">add</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">sub</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
myObject<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myObject<span class="token punctuation">.</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> sub <span class="token operator">=</span> myObject<span class="token punctuation">.</span>sub<span class="token punctuation">;</span>
<span class="token function">sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1  3  3  4  4</span>
<span class="token comment">//核心问题在于：自执行函数生成私有作用域，执行完后销毁，且自执行函数中this指向window</span>
</code></pre></div><hr> <h2 id="循环绑定click点击事件-腾讯面试题"><a href="#循环绑定click点击事件-腾讯面试题" class="header-anchor">#</a> 循环绑定click点击事件(腾讯面试题)</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;btnBox&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;button&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;button_1&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;button&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;button_1&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;button&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;button_1&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;text/javascript&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">var</span> btnBox <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btnBox'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  inputs <span class="token operator">=</span> btnBox<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> l <span class="token operator">=</span> inputs<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    inputs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>onclick<span class="token operator">=</span><span class="token function">functon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">原因分析</p> <ol><li>以上代码能正常执行么？为啥不行？
<ul><li>事件绑定是&quot;异步编程&quot;，当触发点击行为，绑定的方法执行的时候，外层循环已经结束：方法执行产生私有作用域，用到变量i，i不是私有的变量，按照&quot;作用域链&quot;的查找机制，找到的是全局下的i(此时全局的i已经成为循环最后一次的结果3)</li></ul></li> <li>如何解决?
<ol><li>自定义属性：声明一个类，使this指向当前类
<ul><li><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> btnTemp <span class="token operator">=</span> inputs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  btnTemp<span class="token punctuation">.</span>myIndex <span class="token operator">=</span> i<span class="token punctuation">;</span>  <span class="token comment">//给该元素添加一个index属性来存储i</span>
  btnTemp<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>myIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li>闭包
<ul><li><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    inputs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>onclick<span class="token operator">=</span><span class="token function">functon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/*----------------------------*/</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  inputs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>onclick<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li>ES6  （let）</li></ol></li></ol></div> <hr> <h2 id="函数的arguments为什么不是数组？如何转化成数组？"><a href="#函数的arguments为什么不是数组？如何转化成数组？" class="header-anchor">#</a> 函数的arguments为什么不是数组？如何转化成数组？</h2> <p>因为arguments本身并不能调用数组方法，它是一个另外一种对象类型，只不过属性从0开始排，依次为0，1，2...最后还有callee和length属性。我们也把这样的对象称为类数组。<br>
常见的类数组还有：</p> <ol><li>用getElementsByTagName/ClassName()获得的HTMLCollection</li> <li>用querySelector获得的nodeList<br>
那这导致很多数组的方法就不能用了，必要时需要我们将它们转换成数组，有哪些方法呢？</li> <li>Array.prototype.slice.call()</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">sum<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> sum <span class="token operator">+</span> cur<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//args可以调用数组原生的方法啦</span>
<span class="token punctuation">}</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//3</span>
</code></pre></div><ol start="2"><li>Array.from()</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> args <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">sum<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> sum <span class="token operator">+</span> cur<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//args可以调用数组原生的方法啦</span>
<span class="token punctuation">}</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//3</span>
</code></pre></div><p>这种方法也可以用来转换Set和Map</p> <ol start="3"><li>ES6展开运算符</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">sum<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> sum <span class="token operator">+</span> cur<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//args可以调用数组原生的方法啦</span>
<span class="token punctuation">}</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//3</span>
</code></pre></div><ol start="4"><li>利用concat+apply</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//apply方法会把第二个参数展开</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">sum<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> sum <span class="token operator">+</span> cur<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//args可以调用数组原生的方法啦</span>
<span class="token punctuation">}</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//3</span>
</code></pre></div><hr> <h2 id="你理解的闭包作用是什么-优缺点-乐视"><a href="#你理解的闭包作用是什么-优缺点-乐视" class="header-anchor">#</a> 你理解的闭包作用是什么? 优缺点? (乐视)</h2> <p>闭包就是函数中返回函数或对象，形成一个不销毁的私有作用域或栈内存，既保护了里面的私有变量不受外部变量的影响，也保存了一些变量信息。（对于保护的功能来说在封装插件的时候，为了避免插件中方法与别的方法重名，使用闭包将方法保护起来，防止全局变量的污染，对于保存来说，有些时候需要做循环事件绑定，而此时用到的索引已经是全局下的，可以用闭包的机制将索引保存下来）</p> <blockquote><p><a href="https://www.cnblogs.com/xiaoai-tang/p/6561740.html" target="_blank" rel="noopener noreferrer">JS高级函数(惰性函数，函数柯里化，级联函数)用到闭包<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="http://www.jikexueyuan.com/course/1272.html" target="_blank" rel="noopener noreferrer">JS高级函数讲解<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://www.jianshu.com/p/ae57baecc57d" target="_blank" rel="noopener noreferrer">你遇到过[ ].slice.call()吗？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//函数柯里化使用闭包</span>
<span class="token keyword">var</span> <span class="token function-variable function">currying</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> _args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>_args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    _args<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> arguments<span class="token punctuation">.</span>callee<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token function-variable function">multi</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> arg<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">pre<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> pre <span class="token operator">+</span> <span class="token function">Number</span><span class="token punctuation">(</span>cur<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> sum <span class="token operator">=</span> <span class="token function">currying</span><span class="token punctuation">(</span>multi<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 1000  （空白调用时才真正计算）</span>

<span class="token comment">// arguments.callee 已被废弃：在现代JavaScript中，arguments.callee 已被废弃，可能导致函数引用问题。</span>
<span class="token comment">// 可以优化成如下代码：</span>
<span class="token keyword">var</span> <span class="token function-variable function">currying</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> _args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">innerFn</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span>_args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 直接传递整个数组</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Array.prototype.push.apply(_args, [].slice.call(arguments));</span>
    _args<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> innerFn<span class="token punctuation">;</span>  <span class="token comment">// 使用函数名而不是 arguments.callee</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> innerFn<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


</code></pre></div><hr> <h2 id="数组去重问题"><a href="#数组去重问题" class="header-anchor">#</a> 数组去重问题</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*-----------方式1(使用对象)------------------*/</span>
<span class="token keyword">function</span> <span class="token function">unique</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> item <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      arr<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    obj<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">;</span>
    i<span class="token operator">++</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*-----------方式2------------------*/</span>
<span class="token keyword">function</span> <span class="token function">unique</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> item <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">/**
       *优化方案一：
       * 不适用splice删除(删除当前项，后面索引都会移动位置，如果后面有很多项，会导致性能消耗大)
       * 解决方案：把最后一项替换当前项，再把最后一项删除即可(会导致数组顺序发生变化)
      */</span>
      <span class="token comment">//原始方案</span>
      <span class="token comment">// arr.splice(i,1);</span>
      <span class="token comment">// i--</span>
      <span class="token comment">// continue;</span>
      <span class="token comment">//优化方案</span>
      arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      arr<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      i<span class="token operator">--</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    obj<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> arr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*--------方式3(将方法添加到原型链上--------*/</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myUnique</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">myUnique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//方法中的this一般都是当前类的实例(也就是我们要操作的数组)</span>
  <span class="token comment">//操作this相当于操作arr，方法执行完成会改变原有数组</span>
  <span class="token comment">/**
   * arr.myUnique()  this -&gt; arr
   * arr.__proto__.myUnique()  this -&gt; arr.__proto__
   * arr.prototype.myUnique()  this -&gt; arr.prototype
  */</span>
  <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> item <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token operator">--</span><span class="token punctuation">,</span>i<span class="token operator">--</span><span class="token punctuation">)</span><span class="token operator">:</span>obj<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  obj <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span><span class="token function">myUnique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3, 6, 5]</span>

<span class="token comment">/*--------方式4(使用数组 reduce方法)--------*/</span>
<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result<span class="token punctuation">,</span>item</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">/*--------方式5(使用ES6 set方法)--------*/</span>
<span class="token keyword">let</span> result <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">/*-------------思考题-------------------*/</span>
<span class="token comment">//var n = 5,使得n.plus(3).minus(2)返回6</span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">pro</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  pro<span class="token punctuation">.</span><span class="token function-variable function">plus</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">plus</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span> <span class="token operator">+</span> <span class="token function">Number</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  pro<span class="token punctuation">.</span><span class="token function-variable function">minus</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">minus</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span> <span class="token operator">-</span> <span class="token function">Number</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token class-name">Number</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> res <span class="token operator">=</span> n<span class="token punctuation">.</span><span class="token function">plus</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">minus</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 6</span>
</code></pre></div><hr> <h2 id="对象中this指向-用友面试题"><a href="#对象中this指向-用友面试题" class="header-anchor">#</a> 对象中this指向(用友面试题)</h2> <div class="tip custom-block"><p class="custom-block-title">核心</p> <ol><li>元素绑定事件，方法中的this是当前操作的元素</li> <li>方法名前面是否有&quot;.&quot;，有&quot;.&quot;，&quot;.&quot;前面是谁this就是谁，没有的话this指向window(严格模式下是undefined)</li> <li>构造函数执行，方法体中的this是当前类的一个实例</li></ol></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> funllName <span class="token operator">=</span> <span class="token string">'language'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">fullName</span><span class="token operator">:</span><span class="token string">'javascript'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">prop</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function-variable function">getFullName</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fullName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>prop<span class="token punctuation">.</span><span class="token function">getFullName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// this =&gt; obj.prop =&gt; 输出obj.prop.fullName =&gt; undefined</span>
<span class="token keyword">var</span> test <span class="token operator">=</span> obj<span class="token punctuation">.</span>prop<span class="token punctuation">.</span>getFullName<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//this =&gt; window =&gt; window.fullName =&gt; language</span>

<span class="token comment">/*----------------变体--------------------*/</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'window'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> Tom <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span> <span class="token operator">:</span> <span class="token string">&quot;Tom&quot;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">show</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; window.name =&gt; window</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">wait</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> fun <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>show<span class="token punctuation">;</span>  <span class="token comment">// this=&gt;Tom =&gt; Tom.show</span>
    <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//this =&gt; window</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
Tom<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//=&gt; window</span>
</code></pre></div><hr> <h2 id="this指向问题-阿里"><a href="#this指向问题-阿里" class="header-anchor">#</a> this指向问题(阿里)</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span> <span class="token operator">:</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getNameFunc</span> <span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>  <span class="token comment">// this =&gt; window</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span><span class="token function">getNameFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// A  [object.getNameFunc()]() 等价于 a = object.getNameFunc(),a() 实际函数是默认执行this指向window</span>
<span class="token keyword">var</span> name2 <span class="token operator">=</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> object2 <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name2</span> <span class="token operator">:</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getNameFunc</span> <span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>  <span class="token comment">//this =&gt; object2 使用闭包变量that保存this</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> that<span class="token punctuation">.</span>name2<span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>object2<span class="token punctuation">.</span><span class="token function">getNameFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// B</span>
</code></pre></div><hr> <h2 id="原型链-腾讯面试题"><a href="#原型链-腾讯面试题" class="header-anchor">#</a> 原型链(腾讯面试题)</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>m <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">aa</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>m<span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">bb</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> f1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">;</span>
<span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">aa</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>m <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> f2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>constructor<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Fn</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f2<span class="token punctuation">.</span>constructor<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Object</span>
f1<span class="token punctuation">.</span><span class="token function">bb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// this -&gt; f1 =&gt; f1.n = undefined</span>
f1<span class="token punctuation">.</span><span class="token function">aa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// this -&gt; f1 =&gt; f1.m = 20</span>
f2<span class="token punctuation">.</span><span class="token function">bb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 找不到bb，报错</span>
f2<span class="token punctuation">.</span><span class="token function">aa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// this -&gt; f2 =&gt; f2.m = 20</span>
f2<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span><span class="token function">aa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// this -&gt; f2.__proto__ =&gt; f2.__proto__.m + 10 = undefined + 10 = NaN</span>
</code></pre></div><p><img src="/assets/img/prototype1.7d3bbc61.png" alt="图片"></p> <hr> <h2 id="原型链问题-京东"><a href="#原型链问题-京东" class="header-anchor">#</a> 原型链问题(京东)</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">F</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a()'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a1()'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'b()'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//console.dir(F);</span>
<span class="token comment">//console.dir(f)</span>
<span class="token constant">F</span><span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// a1()  F是函数，也就是Function()构造函数的实例，直接使用F上的方法会去原型链中找，最后找到Function.prototype上</span>
<span class="token constant">F</span><span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// b()</span>
f<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// a()  // new出来的f是F的实例，而f的原型指向Object，跟Function无关，因此f上的a会去Object中寻找</span>
f<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 报错 Uncaught TypeError: f.b is not a function</span>
</code></pre></div><hr> <p><img src="/assets/img/constuctor_ali.171c0ce6.png" alt="题目说明"> <img src="/assets/img/constructorFunction.3b6d4074.png" alt="原型结构说明"> <img src="/assets/img/example_structor.a0d35c05.png" alt="实例结构说明"></p> <h2 id="阿里超经典面试题-比较难"><a href="#阿里超经典面试题-比较难" class="header-anchor">#</a> 阿里超经典面试题 (比较难)</h2> <p><a href="https://blog.csdn.net/mongo__/article/details/72810338" target="_blank" rel="noopener noreferrer">解题思路<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://blog.csdn.net/cuixiping/article/details/15037061" target="_blank" rel="noopener noreferrer">Javascript解惑之 new A.B() 与 new A().B() 的区别<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://www.jianshu.com/p/8cee7dacd5b6" target="_blank" rel="noopener noreferrer">一道被人轻视的前端面试题<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getName2</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'只在实例中出现'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Foo<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Foo<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 2  调用Foo.getName()方法输出2</span>
<span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// 4 调用windiw.getName(()方法输出4</span>
<span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 1  ( Foo() ).getName()</span>
<span class="token comment">// .优先级最高，但是.getName()无法执行，因此往前找Foo().getName(),先执行Foo(),将全局的getName重新赋值,返回this(因为是当普通函数用，所以this指向默认的window),window.getName()输出1</span>
<span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// 1  上一步将全局的函数重新赋值了，所以输出1</span>
<span class="token keyword">new</span> <span class="token class-name">Foo<span class="token punctuation">.</span>getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2 点的优先级比new高，Foo.getNmae()能找到方法因此先执行 =&gt; new ( Foo.getName() )</span>
<span class="token comment">//.优先级最高，先执行Foo.getName(),输出2</span>
<span class="token comment">//new Foo不带参优先级为17</span>
<span class="token comment">//而‘.’成员访问的优先级为18, 函数调用的优先级为17</span>
<span class="token comment">//根据优先级的顺序应该事18 &gt; 17，所以先执行Foo.getName，然后执行函数调用(Foo.getName)(),最后执行new</span>
<span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 3 ( new Foo() ).getName()</span>
<span class="token comment">//先执行new Foo(),再调用实例中的getName方法，实例中没有再去原型链中找，找到输出3</span>
<span class="token comment">/*
为啥是先new Foo(),再执行getName()方法，而不是Foo().getName(): 
根据下面优先级的顺序来看
new Foo为不带参的优先级17
new Foo()为带参数的优先级为18
而‘.’成员访问的优先级为18, 函数调用的优先级为17
优先级想要同从左往右执行。
所以先执行new Foo(), 然后执行(new Foo()).getName, 最后执行函数(new Foo()).getName
*/</span>
<span class="token keyword">new</span> <span class="token class-name">new</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3  new ( (new Foo()).getName )（）</span>
<span class="token comment">// new Foo()为带参数的优先级为18,而‘.’成员访问的优先级为18, 函数调用的优先级为17</span>
<span class="token comment">//所以先执行new Foo(), 返回实例f， new f(不带参)的优先级仅为17， 而‘.’的成员访问为18，所以再执行new Foo().getName =》 f1, </span>
<span class="token comment">//接下来new f1()的优先级为18， 而new f1 和 f1()的优先级都为17，所以执行new f1(),而不是从左往右分别执行new f1 返回f2,再执行f2()</span>
<span class="token comment">//先执行new Foo(),再找到实例中的getName方法，实例中没有再去原型链中找，，然后new 实例上的getName方法, 执行输出3</span>

<span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//只在实例中出现</span>
<span class="token comment">//new Foo()带参执行为18， ‘.’成员访问为18，函数调用为17，所以从左往右执行new Foo(), 返回实例f，接着执行f.getName得到f1, 最后执行f1()</span>
</code></pre></div><p><img src="/assets/img/ali1.447f03ee.png" alt="结构说明"> <img src="/assets/img/newfirst.2a50854c.jpg" alt="运算符优先级"></p> <hr> <h2 id="闭包对象问题-滴滴-很难"><a href="#闭包对象问题-滴滴-很难" class="header-anchor">#</a> 闭包对象问题(滴滴 很难)</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token parameter">n<span class="token punctuation">,</span> o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">fun</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token function">fun</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// undefiend  形成闭包1 n=0   o=undefined</span>
a<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//0 fun(1,0) =&gt; 形成闭包2 n=1  o=0</span>
a<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//0 fun(2,0) =&gt; 形成闭包3 n=2  o=0</span>
a<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//0 fun(3,0) =&gt; 形成闭包3 n=3  o=0</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//fun0  =&gt;   undefined  返回对象obj0 形成闭包 n=0   o=undefined</span>
<span class="token comment">//.fun(1) =&gt; 0           obj0调用函数fun(1,0),返回对象obj1,形成闭包n=1  o=0</span>
<span class="token comment">//.fun(2) =&gt; 1           obj1调用函数fun(2,1),返回对象obj2,形成闭包n=2  o=1</span>
<span class="token comment">//.fun(3) =&gt; 2           obj2调用函数fun(3,2),返回对象obj3,形成闭包n=3  0=2</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//fun0  =&gt;   undefined  返回对象obj0 形成闭包 n=0 o=undefined</span>
<span class="token comment">//.fun(1) =&gt; 0           obj0调用函数fun(1,0),返回对象obj1,形成闭包n=1  o=0</span>
c<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 1    obj1调用函数fun(2,1),返回对象obj2,形成闭包n=2  o=1</span>
c<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 1    obj1调用函数fun(3,1),返回对象obj22,形成闭包n=3 o=1</span>
</code></pre></div><hr> <h2 id="document-parentnode和document-parentnode的区别？-腾讯"><a href="#document-parentnode和document-parentnode的区别？-腾讯" class="header-anchor">#</a> document.parentNode和document.parentnode的区别？(腾讯)</h2> <p>每个节点都有parentNode节点，但是document是最外层节点，因此它的parentNode属性为null；而parentnode是不存在的属性，因此为undefined.<br>
有这个属性，但是属性值没有则为null；没有这个属性，属性值则为undefined</p> <hr> <h2 id="怎么规避多人开发函数重名的问题-百度搜索"><a href="#怎么规避多人开发函数重名的问题-百度搜索" class="header-anchor">#</a> 怎么规避多人开发函数重名的问题?(百度搜索)</h2> <ol><li>基于单例设计模式</li></ol> <div class="tip custom-block"><p class="custom-block-title">实现单例核心思想</p> <p>无非是用一个变量来标志当前是否已经为某个类创建过对象，如果是，则在下一次获取该类的实例时，直接返回之前创建的对象</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">Singleton</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">name</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">Singleton</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">alert</span> <span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Singleton<span class="token punctuation">.</span>getInstance <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
  <span class="token keyword">var</span> instance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">name</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>instance <span class="token punctuation">)</span><span class="token punctuation">{</span>
      instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span> name <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> sg1 <span class="token operator">=</span> Singleton<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">'小明'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>基于闭包</li> <li>模块化开发 COMMONJS(module.exports 和 require) ES6 (export default 和 import)</li></ol> <div class="tip custom-block"><p class="custom-block-title">exports与module.exports的区别?</p> <p>用一句话来说明就是，require方能看到的只有module.exports这个对象，它是看不到exports对象的，而我们在编写模块时用到的exports对象实际上只是对module.exports的引用。</p></div> <hr> <h2 id="条件语句中定义变量-腾讯"><a href="#条件语句中定义变量-腾讯" class="header-anchor">#</a> 条件语句中定义变量(腾讯)</h2> <p>核心：不管条件是否成立，条件语句中定义的该变量都要进行变量提升。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'World'</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">/**自执行函数执行时，在局部作用域中会将var name进行变量提升，不考虑条件是否成立。*/</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> name <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'Jack'</span><span class="token punctuation">;</span>  <span class="token comment">//name提升后为undefined,进入此处重新赋值Jack</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//输出Jack</span>
</code></pre></div><h2 id="全局及局部作用域变量提升"><a href="#全局及局部作用域变量提升" class="header-anchor">#</a> 全局及局部作用域变量提升</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//函数会生成局部作用域，先进行形参赋值，再进行变量提升</span>
  <span class="token comment">//局部作用域中 var foo(undifiend)  注意：不管条件是否成立，都要进行变量提升，但是新浏览器中对于判断体中的函数只是提前声明</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>foo<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//打印100</span>
</code></pre></div><hr> <hr> <h2 id="条件判断中的函数声明提升-360面试题"><a href="#条件判断中的函数声明提升-360面试题" class="header-anchor">#</a> 条件判断中的函数声明提升(360面试题)</h2> <div class="danger custom-block"><p class="custom-block-title">核心</p> <p>在当前作用域下，不管条件是否成立都要进行变量提升</p> <ul><li>带var的变量只是声明</li> <li>带function的在老版浏览器渲染机制下，声明+定义都处理，但是为了迎合ES6中的块级作用域，新版浏览器对于函数(在条件判断中的函数), 不管条件是否成立，都只是先声明，没有定义，类似于var</li> <li>匿名函数不进行变量提升
条件判断相关</li> <li>条件语句中数据类型默认的布尔值
<ol><li>基本数据类型:' '、0、null、undefiend、NaN在条件判断中都是false    if(' '){console.log('a')}else{console.log('b')}都输出b</li> <li>引用数据类型:[]、{}在条件判断中都是true  if({}){console.log('a')}else{console.log('b')}都输出a</li></ol></li> <li>！语句中数据类型的布尔值
<ol><li>基本数据类型:''、0、null、undefiend、null、NaN在'!'语句后中都是false, 跟条件语句中处理一致  !''  =&gt; true</li> <li>引用数据类型:[]、{}在'!'语句后都是true, 跟条件语句中处理一致  ![] =&gt; false</li></ol></li> <li>'=='语句中强制类型转换
<ol><li>'=='存在强制类型转换,因此在'=='中, ''、0、[]都转化成false，</li> <li>undefiend、null、NaN即不跟false相等，也不跟true相等(undefiend、null、NaN == false/true都为false,但是undefined == null,任何类型都不跟NaN连等, 包括它自己)</li> <li>[]转化成false [] == false 为true ; 而{}无法转化，{} == true/false都报错</li></ol></li> <li>'=='比较规则
<ol><li>如果一个值是null, 另一个是undefined，则它们相等</li> <li>如果一个值是数字，另一个是字符串，先将字符串转换为数字，然后使用转换后的值进行比较</li> <li>如果其中一个值是true，则将其转换为1再进行比较。如果其中一个值是false，则将其转换为0再进行比较。</li></ol></li> <li>'[]'转化规则
<ol><li>'[]'转字符串为' '</li> <li>'[]'转布尔值为true</li> <li>'[]'转数字为0</li></ol></li></ul></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*------------示例------------------*/</span>
<span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">/*
    自执行函数执行时形成私有作用域：
      形参赋值：无
      变量提升：
          function b 在条件判断语句中，因此只声明未定义
          function a 不在条件语句内，直接声明并定义
  */</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 打印a函数</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// undefined</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 2</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 1  全局下的函数b未被自执行函数中的私有变量更改</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Uncaught ReferenceError: a is not defined</span>


<span class="token comment">/*-----------------------例题--------------------------------*/</span>
<span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token function-variable function">g</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token operator">~</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
    自执行函数执行形成私有作用域
      形参赋值：无
      变量提升：function g声明但不定义
      代码执行：g()执行时会报错 Uncaught TypeError: g is not a function
              如果把function g(){}挪到条件判断外面则可以正常执行，声明并定义的function g会覆盖只声明未定义的function g;
              不管function g(){}函数定义在条件语句之前还是之后
              条件判断中g()返回true ![]为false [] == false， 有一方为false，所以false变成0，然后比较[] == 0，[]转换成数字0，0 == 0为true，因此全局函数f被重新赋值，输出false,false
  */</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment">//影响全局作用域中f</span>
    <span class="token keyword">function</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//function g(){return true;} //不加这条语句报错</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 全局定义的g未被影响</span>


<span class="token comment">/****************变量提升变体******************/</span>
<span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token function-variable function">g</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token operator">~</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// 1</span>
    <span class="token comment">//进入判断体中第一件事不是执行代码，而是类似变量提升一样，将函数声明和定义</span>
    <span class="token keyword">function</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// 1</span>
    <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr> <hr> <h2 id="作用域和值类型引用类型的传递"><a href="#作用域和值类型引用类型的传递" class="header-anchor">#</a> 作用域和值类型引用类型的传递:</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;text/javascript&quot;</span><span class="token operator">&gt;</span>
  <span class="token comment">//第一题 作用域</span>
  <span class="token keyword">var</span> num1 <span class="token operator">=</span> <span class="token number">55</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> num2 <span class="token operator">=</span> <span class="token number">66</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token parameter">num<span class="token punctuation">,</span> num1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//首先声明形式参数num，num1，分别赋值传入的55 66</span>
    <span class="token comment">//num = 55 num1 = 66</span>
    num <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>  <span class="token comment">//形式参数num = 100</span>
    num1 <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">//形式参数num1 = 100</span>
    num2 <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">//全局变量num2 = 100</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 打印100</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印100</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印100</span>
  <span class="token punctuation">}</span>
  <span class="token function">f1</span><span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//此处传入值num1:55 num2:66</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//打印 全局num1 = 55</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//打印 全局num2 = 100</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//报错 not defined</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><hr> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> salary</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">=</span> salary<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token parameter">person</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// var person = p</span>
    person<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;ls&quot;</span><span class="token punctuation">;</span>
    person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;aa&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;zs&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//zs</span>
  <span class="token function">f1</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//ls</span>
</code></pre></div><blockquote><blockquote><p>执行过程内存解析
<img src="/assets/img/test1-person.10531be5.png" alt="person"></p></blockquote></blockquote> <h2 id="js变量提升问题"><a href="#js变量提升问题" class="header-anchor">#</a> JS变量提升问题</h2> <p>原则：函数声明提升优先于变量提升，函数声明会被变量赋值影响，但不会被变量声明影响</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>func <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">//function</span>
<span class="token keyword">function</span> <span class="token function">func</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> func

<span class="token comment">/*----------------------------------------------*/</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>func <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">//function</span>
<span class="token keyword">function</span> <span class="token function">func</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> func <span class="token operator">=</span> <span class="token number">10</span>

<span class="token comment">/*----------------------------------------------*/</span>
<span class="token keyword">var</span> func <span class="token operator">=</span> <span class="token number">10</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>func <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">//number</span>
<span class="token keyword">function</span> <span class="token function">func</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//变量提升：不管条件是否成立都要进行变量提升，在全局作用域下声明的变量，</span>
<span class="token comment">//也相当于给window设置了一个对象的属性，而且两者之间建立了映射的机制&lt;=&gt;window.a = undefined</span>
<span class="token comment">/*
in : 检测某一个属性是否隶属于这个对象（不管是私有属性还是共有属性），只要有这个属性结果就是TRUE
hasOwnProperty ： 所有继承了 Object 的对象都会继承到 hasOwnProperty 方法。
这个方法可以用来检测一个对象是否含有特定的自身属性；和 in 运算符不同，
该方法会忽略掉那些从原型链上继承到的属性
*/</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span> <span class="token keyword">in</span> window<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//undefined</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//undefined</span>
</code></pre></div><hr> <h2 id="es6中class和普通构造函数有何区别？"><a href="#es6中class和普通构造函数有何区别？" class="header-anchor">#</a> ES6中class和普通构造函数有何区别？</h2> <ul><li>class在语法上更加贴合面向对象的写法</li> <li>class实现继承更加易读、易理解</li> <li>更易于java等后端语言的使用</li> <li>class本质还是语法糖，编译后其实还是使用的prototype</li></ul> <hr> <h2 id="形参及实参问题"><a href="#形参及实参问题" class="header-anchor">#</a> 形参及实参问题</h2> <p>在JS非严格模式下，函数中的形参变量和arguments存在映射机制（相互影响）</p> <ul><li>第一个形参变量x值修改为100，那么arguments[0]的值也跟着修改为100</li> <li>arguments[1]的值修改为200，那么第二个形参变量y的值也跟着修改为200</li> <li>在严格模式下代码输出3 3 undefined</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> a</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">/**
  1. 形参赋值：x = 1 y = 2 a = 3
  2. 变量提升： 无
  3. 执行代码
     arguments: 函数内置的实参集合，不管是否设置形参，传递的实参值在这个集合中都存在
     argumens ==&gt; {
       0:1
       1:2
       2:3
       length: 3
       callee:函数本身
     }
  */</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//3</span>
  arguments<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//10</span>
<span class="token punctuation">}</span>
a <span class="token operator">=</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a = undefined  b函数中并没有return，所以默认函数的返回值是undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//undefined</span>

<span class="token comment">/*---------------------------------------------------*/</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">/*
  形参： x = 10 y = undefiend
  arguments: {
    0 : 10
    length : 1
  }
  arguments和形参之间的映射是以arguments的索引为基础完成的，
  arguments中有这个索引，浏览器会完成和对应形参变量中的映射机制搭建，
  如果形参个数比arguments个数多，那么多出来的形参是无法和arguments中对应的索引建立关联的

  arguments和形参的映射机制只发生在函数执行后形参赋值的一瞬间，
  此后再操作之前未建立映射的形参和arguments均不能重新建立映射
  */</span>
  arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 100</span>
  arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span>arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// undefiend 300</span>
  y <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 200 300</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYcAAABxCAIAAACxwPiZAAAcsklEQVR4Ae2dDXRV1ZXHBQIkyEdDwAKRyIckQTAlAsURKcoglFnAFKxjqVWW03HCWlKgaqFYKUW70DJarcVZdLClrg6gsMQZpFKRVihSoYJgBAzfGkiMkI+GAEkg6PzCZg6n7953c9/LzcsL2W9lhXP33Wefc/4v988+5559dosvvvjiKv0oAoqAIhA3CLSMm55oRxQBRUARqEVAWUn/DhQBRSC+EEgoLy+Prx5pbxQBRaB5I9BC15Wa9x+Ajl4RiDsEdAYXd1+JdkgRaOYIKCs18z8AHb4iEHcIKCvF3VeiHVIEmjkCykqX/gAWLVq0ffv2cH8NlZWV8+bNO3ToUDiFstOfb9lXvW5HVX7xhZoLV+0+ep4yEuThqqhcEVAEXBEInpVWr149YsQIjwfYtR8NIfQmGrtF+szlsGHD+A0BzZo1q8/FDwUuESYlJU2dOnXhwoVlZWV2RVPek3++/GzoflQkyI2OFhQBRcAPAgGzEs/w0aNH586du2vXLj/Nx4MOBLp+/foHHnhAOgMBPffcc0cufnr06LFu3TqRX3/99ePGjVu6dKlrnw0l5X58/g+7qo6XXBA1I3etpUJFQBFwIhAxK50+ffrll1/+jfV58803L1y49BAWFBS0b98+PT09NzdXvAymRcx9xPuYPHmy+Br8piz+CL9xVaAG1KQKl3zQoRYfPK/f/va3osYA0ETCpbGGMgoixD9Ch0ZRWLJkyZQpU0I0ubQlKEOg0E1ycnIIOnSmsLAwLS3NyEePHo0knLvUpUPL0Vltxw9J/Hp24rUprUwtLSgCikBECETMSomJiV26dNm3b9/eix8KOBEtW16ywxM+ePDg1NRUOgFDSVc2bdo0ffp0nA84YuPGjQjxOCgjWbly5cSJE8ePH+/a6fz8/OHDh0+YMGH37t3QIF4YjLB48eK1a9dSd86cOQsWLBAiQ8Jn586deXl50BZzMRSmTZuGfQpr1qyBdKi7detWdIyERqkOgWZnZ9sdQBPKGzBgAL6STOvkLmOncODAAVvZlIsrPt+YW82KUs2F0Kmc0dGCIqAI1IlAxKyUkJDAM5yRkdGiRQvIaOzYsX379qVMS/KEp6SkMAnKysoykzhoBeZC4a6Lnzr7ZBTwU3BPuITCsEkBRoB9ID78HYRGkzK8A2sIIRq5XRBOgQShLVvuLGMKIoO8uCXOl+jQB3jKqa8SRUARCBCBhChsde7cGRemuLi4a9euo0aNMhZwjnCLli9fLhIPJ6h37954OnwgkWXLlgnjGDveBTyg2bNne+u43qUVFoygTpa98JhoV7jSVVmEI0eOxNuiivSQQkVFBbTrUUVvKQKKQD0RiNhXoj08I57n22+/neWYVq0uL6DgHM2YMQMXgw+PPZpVVVXO/olLtWHDBtS2bNliqAFSQx9H5vnnn3fWEgkrVjJHC6cQImcOGCIRbsJ9Kykp4RaXtlsXorx582b4VyiJW3QvHCt1alfrLTo/4eROTZUoAoqAIBANK1GzTZs2Q4YMsaczcA2rNmZtmEkQd12XYIQIxowZc3HduY9sI4CbMjMzmZrhB9lTs5DvCbM5OTmmLuvcIQr2JWtDEJxZ2zbL5EhYtIaMRJkJKe/gzBq2LCpJ3/DpmHQamyyKMSj6YCSmMDCtdb/urVjnHtS7dWKbFvxm5fu6rq2QGx0tKAKKgB8EGiE6l8eeVer58+fL483CTcjD76ffwerAbiyle08MITX2Kz3zzDOurBRsf9SaItCcEYjSV6oPZDzVeByyYo1LginbH6mP5ajrSge893a/9NJLjz76qFJS1CBrRUXAJwKN4Cv57JmqKQKKQPNEoBF8peYJtI5aEVAEfCKgrOQTKFVTBBSBGCGgrBQjoLUZRUAR8IlATFlp8+Nbf9bleX6O/eVSMIrPXqL2iyeKerbY/dpy95B9/3ZUUxFQBOIcgWj2dkc3pNzl+6g4p3hGZUnl7x98q12XpJT0zn5MVVV+vuD7BZPv7fyIH23VUQQUgSaOQOx8paLdnw38Vn/gOltSeXJ/ScF7RQKdbG70eCufmNTyySU9hw6/uolDrd1XBBQBXwjEzleqPnWuXUoSc7dNC7YOum+gr96pkiKgCDQ/BGLHSmD7yTvHD75x5Fv/M/mjNZcPAyHWhGi45oe8jlgRUATcEYjdDI72oaSvP/ePrZMSyg7rorX796FSRUARiB0rXfe1nvxASSUHSnGaUod2E/TrXFfSL0kRUASaFQKxm8H1n5z+h1l/XD+z9izKb6+90+cLOPky2Bbw9I8vrY4v+Y8T//lKr74ZbZvV96SDVQSaDwIaB9d8vmsdqSLQNBCI3QyuaeChvVQEFIHGRkBZqbG/AW1fEVAE/h4BZaW/x0OvFAFFoLERiCkrEXRCEBzRcJGOuqyk5jtfP0wc3NhB+w/vr460uuorAopAE0IgdqwkZDTuF6OjQGfTHypmzut27ItB035wzYvPniAyLgojWkURUASaBAKxY6WRPx6edc8NTlD87FeadE+yxMFlDWnXvuPlrCpOaypRBBSBpo5A7FgpEKRyd5xt36El8bqBWFMjioAiEIcIxG4XZbjB+4+De2/rmVd/V/rL5deFM6VyRUARuAIQaHxW8gkilPTYg8fZ1Z2c0mT67HNoqqYIKAI2Ao0/FfKzrsR7t+ceL9JAE/ub07IicKUiEDu/g20BEgQHlNue30koXM9bUv3Ayhs33rv9eUPFbZkfif6ad/rpIXB+oFMdRaApIqBxcE3xW9M+KwJXMgKNP4O7ktHVsSkCikDkCCgrRY6Z1lAEFIGGREBZqSHRVduKgCIQOQLKSpFjpjUUAUWgIRGIHSudr6x5PefNALNUsl2AYF1CdudOO6aRcQ35R6K2FYGYIhA7Vira9RnndpOlkj0BJF8iV6XPgcI48M4tozo88vilo76pyCkCP/9J7Q4mQna/OqL9r54+4dOaqikCikCcIxA7VmJ3kkTndsno/KVenQwude6idM1SeSivOv2GtnJ6d/6RanZ+w1PGphYUAUWg6SIQO1YyGBXvL6Wc0K61kURROP7xubQ+bcWNate+Vc9ebaIwolUUAUUgDhGINSuRduntn7xzy8NDScEkcEh07rBhwyJF5+yZzxd8v2DyvZ2/eV9ypHVVXxFQBOIWgdhFnAABlLTq7v8d/8KYiNIuuWJ3ba82k289KKEnLHufKtdz4FxxUqEi0PQQiJ2vxPL2G9/bCCWFhL/Vua7kCur1mW2/k5PCb+6uW1XGGpOeJeAKlAoVgSaHQOx8pb++8H7hzqIVE18VjDgq1/VoSlcEXbNUMnfL6rIHfehp/rO+An1djatQEVAE4goBjc6Nq69DO6MIKAJXxW4Gp2ArAoqAIuAHAWUlPyipjiKgCMQOAWWl2GGtLSkCioAfBJSV/KAUgc6iRYu2b98eQYWYqNIlOhaTprQRRaC+CATPSlVVVTU10Qd/nDtzftsvdrz50J9y/3vvhXMXZHwF2wuR8FN6uKy+I66r/v5DpwZ87fcd+65+Z/tJV10P3uFW7969o9gR6tpQgMKsrKzCwsI4pMsAx6imrhgEgt8ZcPDgwZKSkptvvjkxMTEKmNpc3frmmUNOf3Ymf8txUz11WA9+Dqw7ZCQNVCgpq/7Rk7lrfjMi4/qOrk1UVlZWVFSkpKQ4765evRpKuuuuu5y3Gl2SlJQ0ZcqUzZs3xyFjNjo42oF4QyB4XwlK2rhx4yuvvPLpp5+GjBZPR1wevCF8Iu4aSRR+EMz155/+hYrGGgZhLmkC98q07n+j5kcHTnXq2Dot9WpTN6SAJwgrbdiwoU+fPpMnTy4ru+S70URubu748eNFH/KaNWuW+CbSOpwVYircJZpmtmWXw+mHyKlC3+RjNwqT0nM6FqKvl4pAvCEQvK/ECPnT//DDD0+cODFhwoSMjIwWLVoghESO/in/9idG4A0ZFDr3TR7781FcQlJ5rx1o3629fdeoOQvoH3nr45u/PxR9qI26A/4lk8NSru7aDoNM/fauykvqkoR9Z10PyVubi2675ZqkpLBJw+HcnTt3Dh8+/MiRI3AH/CvO0Zo1a5gl4ZKIcQrTp0+HvNLT0xcuXLhs2TLC/TzatW+lpaVt3boVDDFy9OjRkSNH2ne9y9AQdffu3Utduocpoy+sBKuaTppbWlAE4gqBBmEl1xGWf1zeLatrCOlAVe8v/aCytIoqna5znzS5WjtddPrT9z/jR+52v+nLMFHJwTIke17JE+G1/9BDCn7S885f9OGzv7pU8alf7gs3idu1a9fgwYPFJ2K+JvZhENyQ7OxsuTSN7t69++GHH87JyfFPSdSFyPgNfRQUFGAWsrPNepTpBv4abAjv4MTl5eXhzRl9+LRDhw7RTauNES0oAjFAoEFYiaeiX79+Y8aM6d69u8cY4BH8nb539GLNSHwlD2Xnrd6j0tLHX3ZAsJaQmDB8zrD2Xw47/3IaMZIFs2+8Y2S3ZS8fWbxwiIevhPPCAg0DhALwSihjQaZ1IYtN8MKKFSsGDBggLGMaqrMAcUAfkAiu1tSpU/27NnY3Dhw40LFjx9TUy4E48KntzdXZDVVQBBoLgeDXlXg4R48efffdd4dQEvOpY9sKZTnJHi1yLk/uOXnW9+mU6DPXq/j0DK6WMdWqTatOPTsUvhe6mIWCz3Wlo/mnvadv4hMJ++CVYDmcI4PmggUL5syZA62sXLnSdJIZlr0aZeR2ARqClZgS4pQZJwuDLFSZ9SZb31lmvI888ogthyLXr18f4s3ZClpWBOIHgeB9Jbyk/v37JySEWmaJp+fNPd6et4XBM1m76d++wmyOSdZ7L+xC0u+f+rZLqaUne0537C8F4hCxhs2aFHf5ndQ58aYHvoJDxK2tP9uOkM/AuzNxuLplf5nlJFa7kZgmLt6v+1dl5YVdH5bl3HfZ+XLWwRlhyQYfkFsTJ0588sknxZFJTk7u0aMH7om84YIU7r///hkzZnAJHbD2BL9E9PKLuSFOWURV6JJ0g7YGDRo0d+7cPXv2GD9r6dKl48aNMxznHJpKFIE4QuAL/VxEYMu2E/86a9vZszXR4bFt27aZM2eePXvWu/rPLn68dUpLSzHFb1uNy0mTJtGKLfRZXrVqFc36VFY1RaDREQh+BhdHjOuvK7JtMucHf539YH+PFSVvY/g1uEsyrXPVlFkkt2bPnu2qgFB0vvvd786fPx/Hx6gx78MDYj4YqfeEBXYn4HZ5NGpa0YIiECcI6EkmcfJFaDcUAUXgEgLqK+mfgiKgCMQXAspK8fV9aG8UAUUgdqxkgkvsWJD6fAFsMiCC195qgOWojb+2vIw0vPyQj5f0BPXpmNZVBBSB+iAQO1aS4BJe4denuw1Xd9I9yaTh5eenL1z74rMnNEV4w0GtlhUBbwRCdxV5awd+VwLWJHBk6IPZMBf7ldgJWfW3aoRmzxEO0fsvflD+ySnpANR25uRZ2cEkdc0+7+qK2oNQ0DQSqsgGoqefftrPOyzyX3ZLbU3C3sAHqwYVAUXADwKNzEqHNxxlI2XWdwbAOx+u2NemfW0K3KLdJwZO6Y+QzZPs+WZ75Mdvf8IOTE44YRp4/N1Cdkuyk7vX7dcRlJs5Kd2OrTu+rYA9ltjBGgQXUfSJZFIZObbDL5df5wc71VEEFIGGQKAxWQkmKj38N3F5GBubtmWEXTJTOvWsjdTlAIBIx0xUHUyEC5aUfPl0Jz/RuTQ0c143ft7beuZ793wCMWmCuUjBV31FIBAEGpOVGABRJhJ6YgZjh7YZIfTESQD8SLgJjpK5FXiBzJedkhNKiy8oKwWOrRpUBPwg0JirJ8y8Er/Uljmad0dxfMqPVXAYAAcnfe2xW+xJ2fnKmnOnz3lX567smfZ5PuyhvOqOnVqmpl0+BKpO+6qgCCgCASIQO1+Jd/bm5CMKsrbN2hDL2CLnjCRObnOOTQ4DMIG4JjoXUuPAJpHba9tOC34kJj2vZOLV1W4/oKmOItAQCDSBiBOWn+xVbZbAmdCxBN4QcKhNRUARaHQEYucrRT1UmejJESgYwS1SSooaTK2oCMQ/Ak3AV4p/ELWHioAiECACjbnaHeAw1JQioAhcMQg0I1ZiQYpNmHH4zdErO3lUXPWwPqGFcTUQj85w7rB5P8tRVnw8lPVWDBAInpVIy1Fd7RLdygt+gmklWZudF9fPIH0SikcAsETtmkRMXEpPyCjnukMqXK98PqWs0EM0NBHpSKVdn62E62SInM6EhDGHKHhcso2ezDH1YXMSf46684/kIv7d6qMeDfm5BXf4PLncjzXRwaCd7pgj5zngnK0k/i2oZuAIBL/azXHR+/fvv/POOzkS3+4uwSUp/ZKJI7GFwZYlAFgIyLYM7xTlnrzx2zeIkGeMJ230UyMbbjcmK/TODMB2l+wy3UbZlsRPGYj63NFr/9pD/lP12Z3nNPTZj+9+fHbWrcO62vLoyvn5+SbbVXQWQmrhFmHQTnfMEaAccE4+GD3jPASrWF4Gz0o4SqSoPHz48De+8Q3yDnkkIIMs+HOHLHiGJUyXmLjij0oYP2Eo5Bc4sfckm79lE1NF4Zk9Kz8ic5wkDkAHcpFMBCaINxxwrqnobGXXnlQWV7J7szivhAiYmqoaUrCwDZ1azgBgnBETPCz7sGzjHmUZtR2HTE9Mgjyzl11iaEiUYIcxy4YJyOLgG4dpQto1mBgJbqYzjNm0i5rBEzZnaGBObLPsHRPWpvUO3a8mAZ/xNP1HO+cXnCk/db5/ethMf2RbIBmMnAiMWTJ6PvPMM1ADfMGJwAIdh45DHHaqK5Hb+rhR5CuXg4Bxf5YsWYLOtGnTREIrnDtMej5bSHVONH700UfFmvlNak9MmUstxB6B4FlJxsC5+uvWrWvbti3EJLlzewztzvN2+K2PJUMJavafe2VZFdncCH+DlTgwYPADX9n36n5idInFvXD+c5TLPykfPnsYZcJuO/XqhISHTTLx8ihK7lxX34cnEHJJG3GtdIzftILZjT/cbB5I157ASqcKKugDbHjDnRkn9hbLPnKeW+ipVeuW0ARNY43W08f35aGFKSTGGIOmOY8CHcZ5JMAYC6JGRfavi7tnb4BwhjETgQxR4n6y5R0uy99ynJ6It4gpw1mkzHOGMRu/VejJJBmWofGfBFxWfuyUoSE2iPG9mEuPEYXc+uuukgEZnVKS24bIzaVJfgcTkQKPHHZIoCRnBmASzFDLTq6HfmZmphxwbtwoKIlsw5CR8B2/USDFi/PU85B0x6ZLkmQYEjQZYswtLcQGgYZipXbt2pFglixMQkkMRp438QW+1KsTHhDPZJf+KfLnXuvOZF8jtCI5b7sNugZHwKCAkLv88P+2sAMFnp9ayxfVICypbqqEK6AGF9ABaMWwpGtPOKiAhx9fqWNaR1hJDNYKL7YLI8Bc0rr8Rn6pe/5YKVwPQ+RQjGsYM45k14G1MyOwveGbGRRsVwsXMsSOXMJENVUXhNmBQkZx1cXU52ZodvpPakFbHB1jrPmJdmYV6cEf7pAqJCV+Y8VtrpM4nnxJyYlNmEWyfrpmAIaD0LRdb8NEtCKpz3F/Xn/9dXGUEJKJTziLaRoJ8uy86pCOM92x9FYaUkoSNBrld/CshH904403OteVZHg8P7g80IH8V3zJOSqrqjn3OeU6IZAnCqbwE/7mbU24Ca+E45x4CCPtCcZ5UOEy71aCuusMY4aqQowDTn1yEYdYsy8h30jPb7j3rt5fzU750ZO5v3p6qIevRCuyVIRTg3/EYnO4DMCs9cBKNlkIE2EBMnr33XdJ/wmhTJgwwZnQhQkg/0eSIw8i+/Wvfw1V2a3YI6XM9A1vK0Sol7FEIPh3cAMHDuR/PP6Awg0Dp8akyYUa+HP/bE9x245tKIerYuRM9PiBlfghd648mRLfy5TKqNkFzJJTF1/MFpqycQEi7QlN0wG6Ie2y7IJNXJXSQ39DaOyHFFDgrZ9zPT5EjUvTMcq4YH7CmMWIay5iO4yZkSYkthJAGAUJjaWKsw9GQmdsHVhgxIgR5m26UQspnCyp9p6+iT7rOJAFuTz5sxHXRuS0EpIBWPiLdvmIs8NsCzqDhnDJJadxYWEht0J6wiV0RlZR1hNgLuddI6HRvLw8e55obmkhZggE7yuF4yNeTstiLWNjQccsUjCVYOGG5RvvMcvCtoTm8pTyQ2iunYmXh42n3RkAjFmaYFmdyQ61uLTV7JBgnz2hCWmFBWZcPwzylsosUYvQnkmZDMDOAUIKZpkccMwaM1099uIHbCwwocg+w5iZ54bkIqZRwcoOY7at2d+Fs4dIGAv8SxXXux7CtzYX3TGym4eC3IJNYB9JNYwEYiKznjMDMOQFbbE8ZNawSadOHuPU1FScIHwlJnecNYqnA/VgB7lM2UIWzuXlmrRi0h1LT6CzxYsX5+Tk2OQot/R3LBFo/IgTFoxZWgpZyAgcApiI//C9W4lNTwIfWoMaZFbIdBuyM/+L+GyO3J9+pm8+rTWEGg4XC08mLTtNyN4le6NAQ7SrNutEwH3WU2e1QBRgAdwBXof1HdM7EIMeRuR9Fi266sSyJ64diFth0a7PWA6PiJJk2+TQsW/O+vcM7xWlxh01jpWd7ti5d6lxu9ecW298X6k5o69jVwQUAScCjekrOXvTHCQ+l4qbAxQ6RkXAFYErjZVYP+LHdagNJ+Q1EK+l+1z8sFpBQ1DPvHnzXF8GRd0NVj3EeNQWtKIi0CQQCJ6VwkXnNgk4ougk1EPMBK+Hjhw5smHDhqeeegpK8rAjWxD9ZKbzMKK3FIErGIHg15V4R+sanesTRN5DO7NU4v44Q7RYorbj4NhXaV7P05Z5p26/fY8oSE06zCIob2pk653rEOCgl156iXAq2eCHPmrZ2dkIKSxfvnzQoEFS3cRnIcemEBPV77///oKCAqPGXXwiaI6CCHmBLZdIjFDfXgsa+vsKROCLoD9vv/32Qw899Nhjj+3YsQM/IlLzFUWnNz+xteRQKRVJObn/9YNSePe596pPn6OMhLuo7fiv3SLh8oPf7amprhFNalGQD0JuiTWUqULF/7/p699Vq1ZNmjSptLS2P66fbdu2ET5qbsnlwYMHb731VsrIsWArIOFSbmF25syZYhwJZeIHqQtPOVs0tUxbWlAErkgEgp/BCXNLdC6OAKhFyuUmSyXbGonYYssMFuwQLV5U4xk54+CcDUlkb2iQmlMvvITdK4RxRuGY3HbbbWzzwzB+E7Na1zUmnKC1a9eyY5AlKeMNEVrBYRpRtBh+EHpHEWhKCAS/t1tG74zOjQIVqIcjRKKoGMsqISHmdsiodMM72tPsVI5ln7UtRSCeEQjeV5LoXEKTcAEo12fw7PlmCx+hJE4jHnFwdgRZREFqzlaQsE7E+zXesrneRUhkA64QYe6U8Q1XrFiBc2QrEwMhAVy2UMrEWxF1RS37FqEVrDq5tgjl2ZpaVgSuSASC95WIzr3pppvqw0cctEbsGHB7JFkiAM0ZB0cVZwSZM0gt2C+SRe7p06fLirWJvYJoNm3axFI3beENhQtiYJpG1BXBXNIlVo7QZBWc2RycjtBeAoccaYVAMFsY7FjUmiIQDwgE/w6unqPiHRwHmGVMvN7VRaqn8XiozgITJy5OnTpVwkTjoUvaB0UgrhAI3lcKNzxC3uxbvLnn7DdzioDc4qCyzH/uZ6sFXraj+Y3xjj07nDpWYS4p1Hnqrq3sp8yMzBzSik+klOQHNNVpngjEna/UPL8GHbUioAgYBIJf7TamtaAIKAKKQBQIJJSXux/SGIUtraIIKAKKQP0R0Blc/TFUC4qAIhAkAv8H+ymFzaI8uLoAAAAASUVORK5CYII=" alt="说明"></p> <hr> <hr> <h2 id="严格模式和非严格模式区别"><a href="#严格模式和非严格模式区别" class="header-anchor">#</a> 严格模式和非严格模式区别</h2> <ol><li>严格模式下不允许使用&quot;arguments.callee&quot;和&quot;arguments.callee.caller&quot;
<ul><li>arguments.callee：返回正被执行的 Function 对象，也就是所指定的Function 对象的正文。</li> <li>arguments.callee.caller：返回一个对函数的引用，该函数调用了当前函数。</li></ul></li> <li>严格模式下arguments和形参没有映射机制</li> <li>严格模式下,函数执行，如果没有明确指定执行的主体(函数前面没有加'.')， 不再像非严格模式下一样，统一都交给window，而是让this指向undefiend,代表没有执行主体；“严格模式下，有执行主体this就指向谁，没有执行主体，this就是undefined”</li></ol> <h2 id="逻辑与-和逻辑或"><a href="#逻辑与-和逻辑或" class="header-anchor">#</a> 逻辑与&amp;&amp;和逻辑或||</h2> <p>优先级：逻辑与的优先级高于逻辑或</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">||</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token number">2</span> <span class="token operator">||</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token number">3</span> <span class="token operator">&amp;&amp;</span> <span class="token number">2</span> <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 2</span>
</code></pre></div><h2 id="封装函数进行字符串驼峰命名"><a href="#封装函数进行字符串驼峰命名" class="header-anchor">#</a> 封装函数进行字符串驼峰命名</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//已知有字符串foo='get-element-by-id',写一个function将其转化成驼峰表示法&quot;getElementById&quot;</span>

<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token string">'get-element-by-id'</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token parameter">foo</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//根据某个字符进行切割</span>
  <span class="token keyword">var</span> arr <span class="token operator">=</span> foo<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//获取每个元素中的第一个字符并转换成大写</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//核心在于使用charAt(0)获取第一个字符，然后将其用toUpperCase()方法转换成大写</span>
    arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">toString</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="冒泡排序"><a href="#冒泡排序" class="header-anchor">#</a> 冒泡排序</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">bubbleSort</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//比较轮数</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//比较的具体方法</span>
    <span class="token comment">//比较的范围j在0到数组长度 - 轮数</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> i<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&gt;</span> arr<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//前面的值大于后面的值，交换双方的值</span>
        <span class="token comment">// var tmp = arr[j + 1];</span>
        <span class="token comment">// arr[j + 1] = arr[j];</span>
        <span class="token comment">// arr[j] = tmp;</span>
        <span class="token punctuation">[</span>arr<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> arr<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment">// 简化</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token comment">//前面的值小于后面的值，指针顺位后移</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span>
<span class="token function">bubbleSort</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//[0, 0, 2, 4, 5, 8, 8, 8, 11, 20, 20]</span>
</code></pre></div><h2 id="去除数组中重复性的数据"><a href="#去除数组中重复性的数据" class="header-anchor">#</a> 去除数组中重复性的数据:</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//原数组</span>
<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">Redup</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//创建新数组，插入原数组第一个元素</span>
  <span class="token keyword">var</span> newArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token comment">//依次将原数组中的元素不重复的插入新数组</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>newArr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      newArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="js综合面试题"><a href="#js综合面试题" class="header-anchor">#</a> js综合面试题</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
Foo<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>

<span class="token comment">//请写出下列的输出结果</span>
Foo<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Foo<span class="token punctuation">.</span>getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">new</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="danger custom-block"><p class="custom-block-title">整体代码分析</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1. JS会将变量和函数声明进行提升</span>
  <span class="token comment">//首先进行函数提升</span>
  <span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
  <span class="token comment">//再进行变量提升</span>
  <span class="token keyword">var</span> getName<span class="token punctuation">;</span> <span class="token comment">//undefined 由于getName已经声明为函数，所以变量声明不起作用</span>
  <span class="token comment">//变量提升之后变量getName和函数getName重名，会只保留提升的函数getName()</span>
  <span class="token comment">/******************************************************************/</span>
<span class="token comment">//2. 未被提升的代码依次执行</span>
Foo<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>   <span class="token comment">//由于前面提升的时候声明了函数getName,</span>
<span class="token comment">//因此这里的函数对getName赋值会覆盖之前的getName函数。</span>

<span class="token comment">/*
优先级：（） 19 
'.'成员访问  new Foo()构造函数带参 18
函数调用  new Foo不带参  17
*/</span>

<span class="token comment">//结果</span>
Foo<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// 2</span>
<span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">// 4</span>
<span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// 1</span>
<span class="token comment">// '.'的优先级为18，函数调用为17，所以先执行成员访问，</span>
<span class="token comment">//但是().getName()获取不到方法， 因此先执行Foo()函数,再执行.getName()方法。</span>
<span class="token comment">//因为Foo()中的getName方法并没有用var声明，因此会寻找沿着作用域链找到全局的getName，</span>
<span class="token comment">//然后对getName重新赋值为函数fucntion(){alert(1);}</span>
<span class="token comment">//由于Foo()是被window调用的，所以Foo()中return this返回的就是window对象，所以最终是window.getName()方法调用输出1</span>
<span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 找到全局中的getName方法  1</span>
<span class="token keyword">new</span> <span class="token class-name">Foo<span class="token punctuation">.</span>getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// '.'的优先级18，，new Foo不带参优先级为17， 先执行Foo.getName =&gt; fn，再执行new fn()---&gt; new (Foo.getName)()  </span>
<span class="token comment">//---&gt;  new (fucntion(){alert(2);})() </span>
<span class="token comment">// 输出 2  并生成实例对象</span>
<span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// '.'的优先级18, new Foo()优先级18，优先级一样从左往右执行, 因此先执行new Foo()再执行getName()方法  </span>
<span class="token comment">//(new Foo()).getName()  ---&gt; 实例对象foo.getName()  </span>
<span class="token comment">//Foo本身并未声明getName方法，因此会去原型链上找到Foo.prototype.getName  //  输出  3  并生成实例对象</span>
<span class="token keyword">new</span> <span class="token class-name">new</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//new Foo()优先级18， '.'优先级18，先执行new Foo() =&gt; foo(返回实例)</span>
<span class="token comment">//然后new foo优先级17， '.'优先级18， 函数调用优先级17，因此执行foo.getName =&gt; fn(返回的函数)，再执行new fn()</span>
<span class="token comment">// 先new Foo(),再调用getName,再new</span>
<span class="token comment">// new ((new Foo()).getName)()  --&gt; </span>
<span class="token comment">// new (实例foo.getName)()  --&gt;</span>
<span class="token comment">// new (function(){alert(3)})()</span>
<span class="token comment">// 输出 3  并生成实例对象</span>
</code></pre></div></div> <hr> <h2 id="函数防抖和函数节流"><a href="#函数防抖和函数节流" class="header-anchor">#</a> 函数防抖和函数节流</h2> <div class="tip custom-block"><p class="custom-block-title">概念</p> <p>函数节流：是确保函数在特定的执行时间(周期)内至多执行一次。</p> <ul><li>一个函数执行一次后，只有大于设定的执行周期后才会执行第二次</li> <li>有个需要频繁触发的函数，出于性能优化角度，在规定时间内，只让函数触发的第一次生效，后面不生效
函数防抖：是函数在特定的时间内不被再调用后执行。</li> <li>一个需要频繁触发的函数，在规定的时间内，只让最后一次生效，前面的不生效</li></ul></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//节流函数</span>
<span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//记录上一次函数触发的时间</span>
  <span class="token keyword">let</span> lastTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//获取参数</span>
    <span class="token keyword">const</span> args <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
    <span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">//记录当前函数触发的时间</span>
    <span class="token keyword">let</span> nowTime <span class="token operator">=</span> Data<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>nowTime <span class="token operator">-</span> lastTime <span class="token operator">&gt;</span> delay<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">//修正this指向问题</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//同步时间</span>
      lastTime <span class="token operator">=</span> nowTime<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span>onscroll <span class="token operator">=</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'scroll事件被触发'</span> <span class="token operator">+</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//防抖函数</span>
<span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//记录上一次的延时器</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> args <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
    <span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">// let args = [].slice.call(arguments)</span>
    <span class="token comment">//arguments这个”伪数组“,除了不是”原型继承自’Array.prototype‘“之外，其他特征和数组是一样的。所以可以当作数组使用</span>
    <span class="token comment">//清除上一次的延时器</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//重新设置新的延时器</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">//修复this指向问题</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'点击事件被触发了'</span> <span class="token operator">+</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</code></pre></div><hr> <h2 id="node-js的事件轮询机制"><a href="#node-js的事件轮询机制" class="header-anchor">#</a> node.js的事件轮询机制</h2> <p><a href="https://www.jianshu.com/p/ca480f9e7dea" target="_blank" rel="noopener noreferrer">js 异步执行顺序<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://www.imooc.com/article/281793" target="_blank" rel="noopener noreferrer">js异步梳理：1.从浏览器的多进程到JS的单线程，理解JS运行机制<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://www.v2ex.com/amp/t/474900" target="_blank" rel="noopener noreferrer">js 异步 microtask 和 macrotask 的时机问题<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://www.cnblogs.com/dasusu/p/10081231.html" target="_blank" rel="noopener noreferrer">JavaScript进阶之异步回调的执行时机<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://www.jianshu.com/p/ab1a02e863be" target="_blank" rel="noopener noreferrer">JavaScript异步精讲，让你更加明白Js的执行流程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://segmentfault.com/a/1190000017204460" target="_blank" rel="noopener noreferrer">浏览器进程线程、Web Workers、Event Loop 图解<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://segmentfault.com/a/1190000009522006" target="_blank" rel="noopener noreferrer">作用域和执行上下文<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout()'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setImmediate()'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'process.nextTick()'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//不管上面三个函数位置如何调换，输出始终不变</span>
process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//process.nextTick方法可以在当前&quot;执行栈&quot;的尾部----下一次Event Loop（主线程读取&quot;任务队列&quot;）之前----触发回调函数。</span>
<span class="token comment">//setImmediate方法则是在当前&quot;任务队列&quot;的尾部添加事件，也就是说，它指定的任务总是在下一次Event Loop时执行</span>
<span class="token comment">//代码执行分析</span>
<span class="token comment">//</span>
<span class="token comment">//1. 首先进入timers阶段，优先执行process.nextTick，输出process.nextTick()，然后发现setTimeout的计时为0，那么执行到点的定时器回调函数输出setTimeout()</span>
<span class="token comment">//2. 依次向后执行到check阶段时，执行setImmediate的回调函数输出setImmediate()</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">说明</p> <p>node.js事件轮询机制: 借助<a href="https://github.com/libuv/libuv/blob/v1.x/src/unix/core.c" target="_blank" rel="noopener noreferrer">libuv库 uv_run<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>实现的
概括事件轮询机制，分为6个阶段：</p> <ol><li>timers 定时器阶段
-- 计时和执行到点的定时器回调函数</li> <li>pending callbacks
-- 某些系统操作(例如TCP错误类型)的回调函数</li> <li>idle, prepare
-- 准备工作</li> <li>poll轮询阶段（轮询队列）</li></ol> <pre><code>1) 如果轮询队列不为空:
    依次同步取出轮询队列中第一个回调函数执行,  
    直到轮询队列为空或者达到系统最大的限制
2) 如果轮询队列为空:
    一、如果之前设置过setImmediate函数
        直接进入下一个check阶段
    二、如果之前没有设置过setImmediate函数
        在当前poll阶段等待
          直到轮询队列添加回调函数,就去第一个情况1)执行
          如果定时器到点了，回去下一个阶段
</code></pre> <ol start="5"><li>check 查阶段
-- 执行setImmediate设置的回调函数</li> <li>close callbacks 关闭阶段
-- 执行close事件回调函数</li></ol> <p>process.nextTick能在任意阶段优先执行</p></div> <hr> <h2 id="node-js的event-loop中promise-then-和process-nexttick执行顺序问题"><a href="#node-js的event-loop中promise-then-和process-nexttick执行顺序问题" class="header-anchor">#</a> Node.js的Event Loop中promise.then()和process.nextTick执行顺序问题</h2> <p><a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html" target="_blank" rel="noopener noreferrer">Node.js的Event Loop<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- extra-class"><pre class="language-text"><code>setTimeout(() =&gt; {
    console.log(&quot;setTimeout 1&quot;)
  },0)
process.nextTick(() =&gt; {
  console.log(&quot;nextTick 1&quot;);
  Promise.resolve().then(() =&gt; {
    console.log('promise 1');
  })
})
Promise.resolve().then(() =&gt; {
    console.log(&quot;window has promise&quot;);
    process.nextTick(() =&gt; {
      console.log(&quot;nextTick 2&quot;);
      Promise.resolve().then(() =&gt; {
        console.log('promise 2');
      })
    })
    Promise.resolve().then(() =&gt; {
      console.log('promise 3');
    })
})
  
//输出结果：
nextTick 1
window has promise
promise 1
promise 3
nextTick 2
promise 2
setTimeout 1
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">说明</p> <p>process.nextTick 永远大于 promise.then，原因其实很简单。。。在Node中，_tickCallback在每一次执行完TaskQueue(宏任务队列)中的一个任务后被调用，而这个_tickCallback中实质上干了两件事：</p> <ol><li>nextTickQueue中所有任务执行掉(长度最大1e4，Node版本v6.9.1)</li> <li>第一步执行完后执行_runMicrotasks函数，执行microtask中的部分(promise.then注册的回调),所以很明显 process.nextTick &gt; promise.then</li></ol></div> <p><img src="/assets/img/nextTick_promise.e76d1253.png" alt="执行顺序">
思考：下列代码结果为啥是这样？</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span>
  Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;2-1&quot;</span><span class="token punctuation">)</span>
  Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;2-2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;2-3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment">//1 &gt; 2-1 &gt; 3 -&gt; 2-3 -&gt; 2 -&gt; 2-2</span>

<span class="token comment">/**********************下列代码在Node和浏览器中执行不一样***************************/</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> pro <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  pro<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;2-1&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> pro <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;2-2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  pro<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;2-3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment">//node结果： 1 &gt;2 &gt; 2-1 &gt; 2-2 &gt; 3 &gt; 2-3</span>
<span class="token comment">//chrome结果：1 &gt; 2 &gt; 3 &gt; 2-1 &gt; 2-2 &gt; 2-3</span>
<span class="token comment">//浏览器中严格按照一个宏任务，一个微任务队列来执行</span>
<span class="token comment">//而Node中不是按照这个方式来执行，宏任务可以是一个队列, 等宏任务队列执行完成才执行nextTick队列，最后执行微任务队列</span>
</code></pre></div><hr> <h2 id="闭包"><a href="#闭包" class="header-anchor">#</a> 闭包</h2> <p>*. 什么是闭包:</p> <ol><li>密闭的容器，类似于set、map容器，存储数据的</li> <li>闭包是一个对象，存放数据的格式：key:value的形式<br>
*. 形成的条件:</li> <li>函数嵌套</li> <li>内部函数引用外部函数的局部变量<br>
*. 闭包的优点:</li> <li>延长外部函数局部变量的生命周期<br>
*. 闭包的缺点:</li> <li>容易造成内存泄漏<br>
*. 注意点:</li> <li>合理的使用闭包</li> <li>用完闭包要及时清除(销毁)</li></ol> <div class="tip custom-block"><p class="custom-block-title">闭包原理</p> <p>注意：只有this是动态作用域，其他的都是词法作用域（即this会随着调用它的对象而改变，而其他变量和函数的私有作用域的上级跟此函数在哪执行无关，只跟它在哪创建有关----&gt; 闭包核心）</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//示例</span>
<span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    count<span class="token operator">++</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> fun2 <span class="token operator">=</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">fun2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//2</span>
<span class="token function">fun2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//3</span>

<span class="token comment">//经典面试题</span>
<span class="token comment">//说出它们的输出情况  （核心：闭包中保存的变量只在当前闭包中存在，嵌套闭包每个都有自己的变量）</span>
<span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token parameter">n<span class="token punctuation">,</span> o</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">fun</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">fun</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">//0被赋值给n, o仅声明未赋值输出 undefined </span>
a<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">//调用return的fun(1,0) n被赋值为1，o被赋值为0 打印的o为0  </span>
a<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment">//调用return的fun(2,0) n被赋值为2，o被赋值为0 打印的o为0  </span>
a<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment">//调用return的fun(3,0) n被赋值为3，o被赋值为0 打印的o为0</span>

<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment">// undefined, 0, 1, 2</span>
<span class="token comment">// 调用fun(0)输出undefined; 返回对象{fun:function (m)} 闭包中'n:0'</span>
<span class="token comment">// 接着调用.fun(1), 实际调用的function(1){return fun(m,n)}, 调用函数fun(1,0) 输出0， 返回对象{fun:function(m)} 闭包中'n:1'  </span>
<span class="token comment">// 再调用.fun(2), function(2),调用fun(2,1), 输出1 返回对象{fun:function (m){ }} 闭包中'n:2'   </span>
<span class="token comment">//最后调用.function(3), 实际调用的fun(3,2), 输出2 返回对象{fun:function (m){ }} 闭包中'n:3'</span>

<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment">//输出undefined, 0, 1， 1</span>
<span class="token comment">//返回对象{fun:function (m){ }}c中闭包保留的n为1</span>
c<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment">//实际调用function (2) {return fun(2,1)} c闭包中n为1 因此调用fun(2, 1) 输出1,返回对象{fun:function (m){ }}中闭包保留的n为2</span>
c<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment">//实际调用function (3){return fun(3,1)} c闭包中n为1 因此调用fun(3, 1)  输出1,返回对象{fun:function (m){ }}中闭包保留的n为3</span>
<span class="token comment">//</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">b</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> b <span class="token operator">+</span> a<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 5</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 5</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 6</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 2</span>
</code></pre></div><p><img src="/assets/img/jsbibao1.4a580eac.png" alt="说明1"></p> <hr> <h2 id="变量和函数的私有作用域的上级跟此函数在哪执行无关，只跟它在哪创建有关？"><a href="#变量和函数的私有作用域的上级跟此函数在哪执行无关，只跟它在哪创建有关？" class="header-anchor">#</a> 变量和函数的私有作用域的上级跟此函数在哪执行无关，只跟它在哪创建有关？</h2> <p>示例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//	这是	foo.js	文件里的代码 </span>
<span class="token keyword">var</span>	b	<span class="token operator">=</span>	<span class="token number">2</span><span class="token punctuation">;</span> 
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span>	<span class="token operator">=</span>	<span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token punctuation">{</span>	
  <span class="token comment">//	导出function </span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span><span class="token punctuation">;</span> 
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//	这是test.js	文件里的代码 </span>
<span class="token keyword">var</span>	foo	<span class="token operator">=</span>	<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./foo.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
<span class="token comment">//	引入function	为foo </span>
<span class="token keyword">var</span>	a	<span class="token operator">=</span>	<span class="token number">1</span><span class="token punctuation">;</span> 
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//	node	执行	test.js	输出： </span>
<span class="token comment">//	-&gt;	2 </span>
<span class="token comment">//	-&gt;	ReferenceError:	a	is	not	defined </span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">var</span>	b	<span class="token operator">=</span>	<span class="token number">2</span><span class="token punctuation">;</span> 
<span class="token keyword">function</span>	<span class="token function">foo</span>	<span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token punctuation">{</span> 
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//	2 </span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//	error </span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span>	<span class="token keyword">function</span>	<span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token punctuation">{</span> 
  <span class="token keyword">var</span>	a	<span class="token operator">=</span>	<span class="token number">1</span> 
  <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><hr> <h2 id="this关键字的机制和定义"><a href="#this关键字的机制和定义" class="header-anchor">#</a> this关键字的机制和定义</h2> <p>this则是一个复杂的机制，JavaScript标准定义了[[thisMode]]	私有属性。</p> <p>[[thisMode]]	私有属性有三个取值。</p> <ol><li>lexical：表示从上下文中找this，这对应了箭头函数。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">const</span>	<span class="token function-variable function">showThis</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
  <span class="token keyword">var</span>	o	<span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">showThis</span><span class="token operator">:</span>	showThis <span class="token punctuation">}</span>
  <span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//	global </span>
  o<span class="token punctuation">.</span><span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//	global</span>
</code></pre></div><ol start="2"><li>global：表示当this为undefined时，取全局对象，对应了普通函数。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span>	<span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span>	o	<span class="token operator">=</span>	<span class="token punctuation">{</span> <span class="token literal-property property">showThis</span><span class="token operator">:</span>	showThis <span class="token punctuation">}</span>
<span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// global </span>
o<span class="token punctuation">.</span><span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// o</span>
</code></pre></div><ol start="3"><li>strict：当严格模式时使用，this严格按照调用时传入的值，可能为null或者undefined
非常有意思的是，方法的行为跟普通函数有差异，恰恰是因为class设计成了默认按strict模式执行。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//class中this的使用</span>
<span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token punctuation">{</span> <span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span>	o	<span class="token operator">=</span>	<span class="token keyword">new</span>	<span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">var</span>	showThis	<span class="token operator">=</span>	o<span class="token punctuation">.</span>showThis<span class="token punctuation">;</span>
<span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//	undefined </span>
o<span class="token punctuation">.</span><span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//	o</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">//严格模式中this的使用</span>
  <span class="token string">&quot;use	strict&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
  <span class="token keyword">var</span>	o <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">showThis</span><span class="token operator">:</span>	showThis <span class="token punctuation">}</span>
  <span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//	undefined </span>
  o<span class="token punctuation">.</span><span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//	o</span>
</code></pre></div><hr> <h2 id="对象中方法的闭包及this指向问题"><a href="#对象中方法的闭包及this指向问题" class="header-anchor">#</a> 对象中方法的闭包及this指向问题</h2> <div class="danger custom-block"><p class="custom-block-title">问题核心</p> <ol><li>在非严格模式下，自执行函数中的this指向window</li> <li>在非严格模式下，函数未用&quot;.&quot;方式调用时函数中this指向全局对象window</li> <li>使用&quot;.&quot;方式调用函数，函数中的this指向&quot;.&quot;之前的对象</li></ol></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">num</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>fn<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> num <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span>
  num<span class="token operator">++</span><span class="token punctuation">;</span>  <span class="token comment">//返回的函数中用到了这个形参变量，形成闭包</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">+=</span> n<span class="token punctuation">;</span>
    num<span class="token operator">++</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>num<span class="token punctuation">)</span>
<span class="token keyword">var</span> fn <span class="token operator">=</span> obj<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment">// =&gt; 22</span>
obj<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// =&gt; 23</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; 65 30</span>
</code></pre></div><p><img src="/assets/img/obj_this.3084881a.png" alt="obj_this"></p> <p>变体</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">num</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>fn<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  num <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> num <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">+=</span> <span class="token operator">++</span>num<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
<span class="token keyword">var</span> fn <span class="token operator">=</span> obj<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 51 42</span>
</code></pre></div><hr> <h2 id="数组作为参数传入"><a href="#数组作为参数传入" class="header-anchor">#</a> 数组作为参数传入</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
  变量提升
    var arr;
    fn = aaafff000
    var res
*/</span>
<span class="token keyword">var</span> arr <span class="token operator">=</span>  <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// arr = bbbfff111 [全局变量]</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">/*
    形参赋值：arr = bbbfff111 [私有变量]
  */</span>
  arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//  bbbfff111 =&gt; [0,2,3,4]</span>
  arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">// =&gt; arr = bbbfff222 [0]</span>
  arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">// bbbfff222 [100]</span>
  <span class="token keyword">return</span> arr<span class="token punctuation">;</span> <span class="token comment">// return bbbfff222</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// bbbfff222 =&gt; [100]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// bbbfff111 =&gt; [0,2,3,4]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="i-问题"><a href="#i-问题" class="header-anchor">#</a> i++问题</h2> <div class="danger custom-block"><p class="custom-block-title">(i++)</p> <p>不管是否加括号，i++都是先将i赋值给调用它的语句，最后再执行++操作<br>
var i = 1;10 + (i++)和10 + i++执行之后都是11，i=2</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token punctuation">(</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 30</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 60</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 80</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>       <span class="token comment">// 41</span>
</code></pre></div><p><img src="/assets/img/variable-plus.e170bb81.png" alt="variable-plus"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 31</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 32</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 43</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 44</span>
</code></pre></div><hr> <h2 id="变量提升-预处理-执行上下文"><a href="#变量提升-预处理-执行上下文" class="header-anchor">#</a> 变量提升/预处理 &amp;&amp; 执行上下文</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
js引擎在代码正式执行之前会做一个预处理的工作:  
  1. 收集变量  
  2. 收集函数  
  依据：  
    var 将var后边的变量定义但是不赋值 var username = undefined;  
    function(){}  提前定义该函数
*/</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//undifiend</span>
<span class="token keyword">var</span> username <span class="token operator">=</span> <span class="token string">'kobe'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//kobe</span>

<span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//fun()</span>
<span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fun()'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//执行上下文（execute context/EC/Execution Context）  </span>
<span class="token comment">/*
理解：代码执行的环境
时机：代码正式执行之前会进入到执行环境    ----作用域在代码定义时产生  
工作：  
  1. 创建变量对象  --变量提升
    1). 变量
    2). 函数及函数的参数
    3). 全局: window
    4). 局部: 抽象的但是确实存在
  2. 确认this的指向
    1). 全局: this ---&gt; window
    2). 局部: this ---&gt; 调用其的对象
  3. 创建作用域链
    父级作用域链 + 当前的变量对象
  4. 扩展:
    ECObj = {
      变量对象: {变量， 函数， 函数的形参}
      scopeChain: 父级作用域链 + 当前的变量对象
      this: {window || 调用其的对象}
    }
*/</span>
</code></pre></div><h2 id="宏任务-微任务"><a href="#宏任务-微任务" class="header-anchor">#</a> 宏任务 &amp;&amp; 微任务</h2> <p>JS是单线程的<br> <a href="https://www.cnblogs.com/jiangyuzhen/p/11064408.html" target="_blank" rel="noopener noreferrer">微任务、宏任务、同步、异步、Promise、Async、await<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://blog.csdn.net/qq_42606051/article/details/81736462" target="_blank" rel="noopener noreferrer">微任务、宏任务与Event-Loop<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://www.cnblogs.com/mmykdbc/p/10401759.html" target="_blank" rel="noopener noreferrer">JS宏任务与微任务执行顺序（仅参考）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://tobethelight.github.io/2018/03/11/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%92%8Cnode%E4%B8%8D%E5%90%8C%E7%9A%84%E4%BA%8B%E4%BB%B6%E6%89%A7%E8%A1%8C%E5%92%8C%E5%BE%AA%E7%8E%AF%E6%9C%BA%E5%88%B6/" target="_blank" rel="noopener noreferrer">浏览器和node不同的事件执行和循环机制（仅参考）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://cnodejs.org/topic/5a9108d78d6e16e56bb80882" target="_blank" rel="noopener noreferrer">不要混淆nodejs和浏览器中的event loop<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://github.com/SunShinewyf/issue-blog/issues/34" target="_blank" rel="noopener noreferrer">node中的Event模块<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br>
宏任务：<br>
  分类：在浏览器环境中，常见的 macro task 有 setTimeout、setInterval、MessageChannel、postMessage、requrestAnimationFrame；在Node中有setImmediate、setTimeout、setInterval</p> <p>  1. 宏任务所处的队列就是宏任务队列<br>
  2. 第一个宏任务队列中只有一个任务：执行主线程的JS代码<br>
  3. 宏任务队列可以有多个<br>
  4. 当宏任务队列中的任务全部执行完后会查看是否有微任务队列，如果有则先执行微任务队列，如果没有就查看是否有宏任务队列</p> <p>微任务:<br>
 分类：浏览器有new Promise().then(回调)中的回调、MutationObserver ; Node中有process.nextTick<br>
  1. 微任务所处的队列就是微任务队列<br>
  2. 只有一个微任务队列<br>
  3. 在上一个宏任务执行完毕后如果有微任务队列就会执行微任务队列中的所有任务</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">--------------------------面试题-----------------------------</span><span class="token regex-delimiter">/</span></span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'----------------start-----------------'</span><span class="token punctuation">)</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> 
<span class="token comment">//setTimeout是宏任务，应该被放置到宏任务队列中，但是第一个宏任务队列只能执行JS主线程上的代码，所以被放到第二个宏任务队列中</span>

<span class="token comment">//new Promise本身是同步任务。被主线程执行</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//此处是在主线程中执行的代码，应该打印i的值</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//执行到resolve进入回调函数</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//修改promise实例对象的状态为成功的状态</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//Promise的回调函数是微任务，因此会放到微任务队列中,会等待第一个宏任务队列完成后执行</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise实例成功回调执行'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'----------------end-----------------'</span><span class="token punctuation">)</span>

<span class="token comment">//整体分析是先执行主线程打印'start',然后打印 '0 - 4', 然后打印'end', 再打印'promise实例成功回调执行'，最后打印'setTimeout'</span>
主线程（第一个宏任务） <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">&gt;</span>  微任务队列  <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token operator">&gt;</span> 第二个宏任务
</code></pre></div><p><img src="/assets/img/tisk.c696ed13.png" alt="task"></p> <p><a href="https://blog.csdn.net/qq_41681425/article/details/85775077" target="_blank" rel="noopener noreferrer">async/await以及js中的微任务和宏任务<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://segmentfault.com/q/1010000016147496" target="_blank" rel="noopener noreferrer">参考链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">--------------------------面试题2-----------------------------</span><span class="token regex-delimiter">/</span></span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 start'</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async1 end'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async2'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script start'</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">resolve</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span>
 <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise2'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span>

<span class="token comment">//输出 script start  --&gt; async1 start  --&gt; async2  --&gt; promise1  --&gt; </span>
<span class="token comment">//script end  --&gt; async1 end  --&gt; promise2  --&gt; setTimeout</span>
</code></pre></div><p>核心：</p> <ol><li><p>async做了一件什么事情？
async将你的函数返回值转换为promise对象，不需要显式地返回promise对象，async关键字自动将函数的返回值变为promise对象。</p></li> <li><p>await的作用
await关键字只能在带有async关键字的函数内部使用，在外部使用时会报错。await等待的是右侧的[表达式结果]，如果右侧是一个函数，等待的是右侧函数的返回值，如果右侧的表达式不是函数则直接是右侧的表达式。await在等待时会让出线程阻塞后面的执行。await的执行顺序为从右到左，会阻塞后面的代码执行，但并不是直接阻塞await的表达式。</p></li></ol> <p>await之后如果不是promise，await会阻塞后面的代码，会先执行async外面的同步代码，等外面的同步代码执行完成在执行async中的代码。</p> <p>如果它等到的是一个 promise 对象，await 也会暂停async后面的代码，先执行async外面的同步代码，等着 Promise 对象 fulfilled，然后把 resolve 的参数作为 await 表达式的运算结果。</p> <p>记住，await之后的代码必须等await语句执行完成后（包括微任务完成），才能执行后面的，也就是说，<font color="red">只有运行完await语句，才把await语句后面的全部代码加入到微任务行列</font>，所以，在遇到await promise时，必须等await promise函数执行完毕才能对await语句后面的全部代码加入到微任务中，所以，</p> <p>在等待await Promise.then微任务时，</p> <ol><li><p>运行其他同步代码，</p></li> <li><p>等到同步代码运行完，开始运行await promise.then微任务，</p></li> <li><p>await promise.then微任务完成后，把await语句后面的全部代码加入到微任务行列，</p></li> <li><p>根据微任务队列，先进后出执行微任务</p></li></ol> <p><font color="red">await 语句是同步的，await语句后面全部代码才是异步的微任务</font></p> <p>async await宏任务微任务(难度较高)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">t1</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>           <span class="token comment">//  一  -&gt;  1</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>           <span class="token comment">//  二  -&gt;  2</span>
  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span> <span class="token keyword">function</span> <span class="token punctuation">(</span> <span class="token parameter">resolve</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'promise3'</span> <span class="token punctuation">)</span>     <span class="token comment">// 三  -&gt;  promise3</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'promise4'</span> <span class="token punctuation">)</span>     <span class="token comment">//推入第一个微任务队列，编号1-1     //  九  -&gt; promise4  //然后执行1-2</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">//遇见await，会执行await右边的代码，等await中代码执行完之前阻塞后续的代码（await后面是promise则会等promise代码中resolve执行完之后才将await之后的代码推入微任务队列中）</span>
  <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span> <span class="token keyword">function</span> <span class="token punctuation">(</span> <span class="token parameter">resolve</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'b'</span> <span class="token punctuation">)</span>           <span class="token comment">//   四  -&gt;  b</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'t1p'</span> <span class="token punctuation">)</span>         <span class="token comment">//  推入第一个微任务队列，编号1-2   //  十  -&gt;  t1p   </span>
    <span class="token comment">//执行完成后await语句完成，会将后续的代码放入微任务队列中，然后执行 1-3 </span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">//阻塞状态   //  放入第一个微任务队列，编号 1-5</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>   <span class="token comment">//  十三  -&gt;  3</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>   <span class="token comment">//  十四  -&gt;  4</span>

  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span> <span class="token keyword">function</span> <span class="token punctuation">(</span> <span class="token parameter">resolve</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'promise5'</span> <span class="token punctuation">)</span>   <span class="token comment">//  十五  -&gt;  promise5</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'promise6'</span> <span class="token punctuation">)</span>   <span class="token comment">//  推入第一个微任务队列，编号1-7，然后执行1-6  //  十八  -&gt;  promise6  微任务队列执行完毕，然后执行第二个宏任务队列</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'setTimeout'</span> <span class="token punctuation">)</span>  <span class="token comment">//推入第二个宏任务队列   //  十九  -&gt;  setTimeout</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">t2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>     <span class="token comment">//   六  -&gt;  5</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>     <span class="token comment">//   七  -&gt;  6</span>
  <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'t2p'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// 推入第一个微任务队列，编号1-4   </span>
  <span class="token comment">//  十二  -&gt; t2p  </span>
  <span class="token comment">//  await执行完成，将后续代码放入第一个微任务队列，编号1-6，然后执行1-5</span>
  <span class="token comment">//遇到await，阻塞</span>
  <span class="token comment">// 编号1-6</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>  <span class="token comment">//  十六  -&gt;  7</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>  <span class="token comment">//  十七  -&gt;  8  //然后执行1-7</span>
<span class="token punctuation">}</span>

<span class="token function">t1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span> <span class="token keyword">function</span> <span class="token punctuation">(</span> <span class="token parameter">resolve</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'promise1'</span> <span class="token punctuation">)</span>    <span class="token comment">// 五  -&gt;  promise1</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'promise2'</span> <span class="token punctuation">)</span>  <span class="token comment">// 推入第一个微任务队列，编号1-3     //  十一  -&gt; promise2  //然后执行1-4</span>
  <span class="token punctuation">}</span> <span class="token punctuation">)</span>

<span class="token function">t2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//  八  -&gt;  end   第一个宏任务队列执行完成，立马执行微任务队列1-1</span>

</code></pre></div><hr> <h2 id="promise-resolve-执行顺序"><a href="#promise-resolve-执行顺序" class="header-anchor">#</a> Promise.resolve()执行顺序</h2> <p>Promise.resolve()用于将现有对象转换为Promise对象，从而控制异步流程。而立即resolve的Promise对象是在<font color="red">本轮“事件循环”（Event loop）的结束时，而不是在下一轮“事件循环”的开始时</font>。<br> <a href="https://www.jianshu.com/p/a72e71fbd46a" target="_blank" rel="noopener noreferrer">从一道题浅说 JavaScript 的事件循环<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="http://es6.ruanyifeng.com/#docs/promise#Promise-resolve" target="_blank" rel="noopener noreferrer">Promise.resolve():阮一峰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token comment">//输出 4 -&gt; 5 -&gt; 3 -&gt; 2 -&gt; 1</span>

<span class="token comment">/****************Promise.resolve()和正常promise顺序*********************/</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token comment">//1 -&gt; 5 -&gt; 2 -&gt; 4</span>
<span class="token comment">//可见立即resolve的Promise对象并不是放在本轮事件循环的末尾，而是放入微任务队列</span>


<span class="token comment">/****************变体********************/</span>
<span class="token comment">//下列代码均输出相同结果</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token comment">//输出 4 -&gt; 5 -&gt; 3 -&gt; 2 -&gt; 1</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
  <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token comment">//输出 4 -&gt; 5 -&gt; 3 -&gt; 2 -&gt; 1</span>
<span class="token comment">//可以认为Promise中resolve的位置不管在哪，</span>
<span class="token comment">//都会把Promise中代码执行完后才将then中代码加入微任务队列</span>
<span class="token comment">//所以 3 先输出， 2 后输出</span>


<span class="token comment">/************特例***************/</span>
<span class="token keyword">let</span> thenable <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">then</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>thenable<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
    	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">t</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 4 -》 3 -》 1 -》 42</span>
</code></pre></div><hr> <h2 id="红绿灯问题"><a href="#红绿灯问题" class="header-anchor">#</a> 红绿灯问题</h2> <p>仿照红绿灯，将div按照绿色3秒，黄色2秒，红色1秒依次变颜色</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">&quot;X-UA-Compatible&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;ie=edge&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Document<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">'div'</span> style<span class="token operator">=</span><span class="token string">&quot;width:500px;height:500px;background-color:green&quot;</span><span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//按照需求将div按绿色3秒，黄色1秒，红色2秒依次变颜色</span>
  <span class="token keyword">var</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">&quot;yellow&quot;</span><span class="token punctuation">;</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">3000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">setInterval</span><span class="token punctuation">(</span>circle<span class="token punctuation">,</span><span class="token number">6000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//使用promise方法</span>
<span class="token keyword">function</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token parameter">duration</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> 
  <span class="token keyword">return</span>	<span class="token keyword">new</span>	<span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>	duration<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> 
  
<span class="token keyword">async</span>	<span class="token keyword">function</span> <span class="token function">changeColor</span><span class="token punctuation">(</span><span class="token parameter">duration<span class="token punctuation">,</span>color</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>background	<span class="token operator">=</span>	color<span class="token punctuation">;</span> 
  <span class="token keyword">await</span>	<span class="token function">sleep</span><span class="token punctuation">(</span>duration<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> 

<span class="token comment">//代码优化 </span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">changeColor</span><span class="token punctuation">(</span><span class="token parameter">duration<span class="token punctuation">,</span>color</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>background	<span class="token operator">=</span>	color<span class="token punctuation">;</span> 
  <span class="token keyword">return</span>	<span class="token keyword">new</span>	<span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>	duration<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> 
<span class="token keyword">async</span>	<span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
  <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
    <span class="token keyword">await</span>	<span class="token function">changeColor</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span><span class="token string">&quot;green&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">await</span>	<span class="token function">changeColor</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span>	<span class="token string">&quot;yellow&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">await</span>	<span class="token function">changeColor</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">,</span>	<span class="token string">&quot;red&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
<span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>

</code></pre></div><hr> <h2 id="js中浅拷贝的手段有哪些？"><a href="#js中浅拷贝的手段有哪些？" class="header-anchor">#</a> JS中浅拷贝的手段有哪些？</h2> <ol><li>手动实现</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">shallowClone</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> target <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> target <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> cloneTarget <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> prop <span class="token keyword">in</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          cloneTarget<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> target<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> cloneTarget<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> target<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>Object.assign
但是需要注意的是，Object.assgin() 拷贝的是对象的属性的引用，而不是对象本身。也就是说，如果源对象某个属性的值是对象，那么目标对象拷贝得到的是这个对象的引用。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'sy'</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> obj2 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> obj<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'sss'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//{ name: 'sss', age: 18 }</span>

<span class="token keyword">const</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> obj2 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>

obj1<span class="token punctuation">.</span>a<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span>a<span class="token punctuation">.</span>b <span class="token comment">// 2</span>
</code></pre></div><ol start="3"><li>concat浅拷贝数组</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> newArr <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
newArr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//[ 1, 2, 3 ]</span>
</code></pre></div><ol start="4"><li>slice拷贝数组</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> newArr <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
newArr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//[1, 2, 3]</span>
</code></pre></div><ol start="5"><li>'...'展开运算符</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> newArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arr<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//跟arr.slice()是一样的效果</span>
</code></pre></div><hr> <h2 id="深拷贝"><a href="#深拷贝" class="header-anchor">#</a> 深拷贝</h2> <p><a href="https://www.jianshu.com/p/2188dcd91090" target="_blank" rel="noopener noreferrer">浅拷贝与深拷贝<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://juejin.im/post/5dbebbfa51882524c507fddb#heading-56" target="_blank" rel="noopener noreferrer">能不能写一个完整的深拷贝？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ol><li>简易版及问题</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
</code></pre></div><p>存在问题：</p> <ol><li>无法解决循环引用的问题：const a = {val:2}; a.target = a;</li> <li>无法拷贝一些特殊的对象，诸如 RegExp, Date, Set, Map等。</li> <li>无法拷贝函数(划重点)。</li></ol> <div class="tip custom-block"><p class="custom-block-title">说明</p> <p>JSON.stringify 只能处理基本对象、数组和原子类型。任何其他类型都可以以难以预测的方式处理。<br>
例如，日期({date: new Date(123)})被转换为字符串({date: &quot;1970-01-01T00:00:00.123Z&quot;})。而 Set、Map、RegExp、Error对象等只是转换为空对象 {}；函数和unfined会被忽略</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> kitchenSink <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">set</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">map</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">regex</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">foo</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
  <span class="token literal-property property">deep</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">array</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token keyword">undefined</span><span class="token punctuation">,</span>
      <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;foo.txt&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;text/plain&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token string">'a'</span>
    <span class="token punctuation">]</span> 
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Hello!'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fn'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token keyword">undefined</span>
<span class="token punctuation">}</span>
​
<span class="token keyword">const</span> veryProblematicCopy <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>kitchenSink<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// 得到结果</span>
<span class="token comment">// jsx复制代码</span>
<span class="token punctuation">{</span>
    <span class="token string-property property">&quot;set&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;map&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;regex&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;deep&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;array&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token keyword">null</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token string">&quot;a&quot;</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'haha'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">,</span>
  <span class="token literal-property property">car</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;奔驰&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;宝马&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;劳斯莱斯&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dog</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'大黄'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">5</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//深拷贝：</span>
<span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
  <span class="token keyword">let</span> result <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>obj <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
          result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">//深拷贝优化(支持基本数据类型、原型链、RegExp、Date类型)</span>
<span class="token comment">//问题：当obj中有属性指向自身时会因循环递归而暴栈  obj[z] = obj</span>
<span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
  <span class="token keyword">let</span> result<span class="token punctuation">;</span> <span class="token comment">// 最后的返回结果</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>obj <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 返回引用数据类型(null已被判断条件排除))</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">RegExp</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// RegExp类型</span>
      result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>source<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>flags<span class="token punctuation">)</span> 
      result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// Date类型</span>
      result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// Array类型</span>
        result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token comment">// Object类型，继承原型链</span>
        <span class="token keyword">let</span> proto <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>proto<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// Array类型 与 Object类型 的深拷贝</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token comment">// 返回基本数据类型与Function类型,因为Function不需要深拷贝</span>
    <span class="token keyword">return</span> obj
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 常规使用这个版本即可</span>
<span class="token comment">/*------------------------简化版本------------------------*/</span>
<span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> result
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">RegExp</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">obj<span class="token punctuation">.</span>constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// 返回基本数据类型和function</span>
        <span class="token keyword">return</span> obj
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/*-------------------------最终优化版----------------------*/</span>
<span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> parent <span class="token operator">=</span> <span class="token keyword">null</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
  <span class="token keyword">let</span> result<span class="token punctuation">;</span> <span class="token comment">// 最后的返回结果</span>

  <span class="token keyword">let</span> _parent <span class="token operator">=</span> parent<span class="token punctuation">;</span> <span class="token comment">// 防止循环引用</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span>_parent<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>_parent<span class="token punctuation">.</span>originalParent <span class="token operator">===</span> obj<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> _parent<span class="token punctuation">.</span>currentParent<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    _parent <span class="token operator">=</span> _parent<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">if</span><span class="token punctuation">(</span>obj <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 返回引用数据类型(null已被判断条件排除))</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">RegExp</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// RegExp类型</span>
      result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>source<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>flags<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// Date类型</span>
      result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// Array类型</span>
        result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token comment">// Object类型，继承原型链</span>
        <span class="token keyword">let</span> proto <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>proto<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// Array类型 与 Object类型 的深拷贝</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">{</span> 
              <span class="token literal-property property">originalParent</span><span class="token operator">:</span> obj<span class="token punctuation">,</span>
              <span class="token literal-property property">currentParent</span><span class="token operator">:</span> result<span class="token punctuation">,</span>
              <span class="token literal-property property">parent</span><span class="token operator">:</span> parent
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token comment">// 返回基本数据类型与Function类型,因为Function不需要深拷贝</span>
    <span class="token keyword">return</span> obj
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">/*-------------------------最终优化版  简化版本----------------------*/</span>
<span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> parent <span class="token operator">=</span> <span class="token keyword">null</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
  <span class="token keyword">let</span> result<span class="token punctuation">;</span> <span class="token comment">// 最后的返回结果</span>

  <span class="token keyword">let</span> _parent <span class="token operator">=</span> parent<span class="token punctuation">;</span> <span class="token comment">// 防止循环引用</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span>_parent<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>_parent<span class="token punctuation">.</span>originalParent <span class="token operator">===</span> obj<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> _parent<span class="token punctuation">.</span>currentParent<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    _parent <span class="token operator">=</span> _parent<span class="token punctuation">.</span>parent<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">if</span><span class="token punctuation">(</span>obj <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 返回引用数据类型(null已被判断条件排除))</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">RegExp</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// RegExp类型</span>
      result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> obj<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// Date类型</span>
      result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">obj<span class="token punctuation">.</span>constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// Array类型 与 Object类型 的深拷贝</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">{</span> 
              <span class="token literal-property property">originalParent</span><span class="token operator">:</span> obj<span class="token punctuation">,</span>
              <span class="token literal-property property">currentParent</span><span class="token operator">:</span> result<span class="token punctuation">,</span>
              parent
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token comment">// 返回基本数据类型与Function类型,因为Function不需要深拷贝</span>
    <span class="token keyword">return</span> obj
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 测试用</span>
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">m</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
    <span class="token function-variable function">z</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">z1<span class="token punctuation">,</span> z2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> z1 <span class="token operator">+</span> z2
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span>x<span class="token punctuation">.</span>m <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="递归遍历所有dom节点"><a href="#递归遍历所有dom节点" class="header-anchor">#</a> 递归遍历所有DOM节点</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">forDom</span><span class="token punctuation">(</span><span class="token parameter">root</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//获取根节点中所有的子节点</span>
  <span class="token keyword">var</span> children <span class="token operator">=</span> root<span class="token punctuation">.</span>children<span class="token punctuation">;</span>
  <span class="token comment">//遍历所有子节点</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> children<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> child <span class="token operator">=</span> children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//显示子节点名字</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child<span class="token punctuation">.</span>nodeName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//判断child下面有没有子节点，如果有子节点，那么就继续的遍历</span>
    child<span class="token punctuation">.</span>children<span class="token operator">&amp;&amp;</span><span class="token function">forDom</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> root <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">;</span>  <span class="token comment">//拿到html节点</span>
<span class="token function">forDom</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="实例对象和构造函数的关系"><a href="#实例对象和构造函数的关系" class="header-anchor">#</a> 实例对象和构造函数的关系</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//自定义构造函数 ----&gt; 实例化对象</span>
<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> sex</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">eat</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'饭'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//构造函数 ---&gt; 创建对象</span>
<span class="token keyword">var</span> per <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'小苏'</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>per<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//显示对象的结构</span>
console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="/assets/img/example_constructor.aaad432d.png" alt="example_constructor"></p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>实例对象是通过构造函数来创建的，实例对象会指向自己的构造函数
实例对象的构造器(构造函数)<br>
实例对象中有__proto__属性，叫做原型。不是标准的属性，是给浏览器使用的（IE8不支持，谷歌和火狐支持）
构造函数中有prototype属性，叫做原型。是标准的属性，是给程序员用的。</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>per<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Person<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//true   </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>per<span class="token punctuation">.</span><span class="token class-name">__proto__</span><span class="token punctuation">.</span>constructor <span class="token operator">==</span> Person<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>per<span class="token punctuation">.</span><span class="token class-name">__proto__</span><span class="token punctuation">.</span>constructor <span class="token operator">==</span> <span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>per <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true  </span>
</code></pre></div><p>实例对象的__proto__中的constructor和构造函数的prototype中的constructor一致</p></div> <div class="tip custom-block"><p class="custom-block-title">实例对象和构造函数的关系</p> <ol><li>实例对象是通过构造函数来创建的 ----&gt; 创建的过程叫实例化</li> <li>如何判断对象是不是这个数据类型?
<ol><li>通过构造器的方式   实例对象.构造器 == 构造函数名字</li> <li>对象  instanceof 构造函数名字</li></ol></li> <li>如何理解JS面向对象
<ol><li>每一个函数(类)都有一个prototype(原型)属性, 属性值是一个对象：这个对象中存储了前类供实例调取使用的共有属性和方法</li> <li>在&quot;浏览器默认&quot;给原型开辟的堆内存中有一个属性constructor：存储的是当前类本身</li> <li>每一个对象(实例)都有一个__proto__(原型链)属性，这个属性指向当前实例所属类的原型(prototype)：不确定所属的类，都指向Object.prototype</li></ol></li> <li>构造函数执行机制
<ol><li>构造函数执行时，在形参赋值和变量提升之后，构造函数内代码执行之前，会在当前形成的私有栈中创建一个对象(创建一个堆内存：暂时不存储任何的东西)，并且让函数中的执行主体(THIS)指向这个新的堆内存(THIS===创建的对象)</li></ol></li> <li>构造函数返回值问题
<ol><li>默认情况下，构造函数会创建一个对象（类的实例），然后让this指向这个对象，最后自动返回这个对象</li> <li>如果自己在构造函数里写了return会怎么样?
<ol><li>如果return的是一个基本值，返回的结果依然是类的实例，没有受到影响</li> <li>如果返回的是引用值，则会把默认返回的实例覆盖，此时接收到的结果就不是当前类的实例了</li></ol></li></ol></li></ol></div> <div class="danger custom-block"><p class="custom-block-title">构造函数、原型对象、实例对象之间的关系</p> <ol><li>构造函数中有个原型对象(prototype),原型对象中有构造器(constructor)，构造器指向构造函数</li> <li>实例对象是由构造函数产生的，实例对象中有原型对象(<strong>proto</strong>),原型对象跟构造函数中原型(prototype)一样
<img src="/assets/img/example_proto.24db3a14.png" alt="example_proto"> <img src="/assets/img/constructor.4a0c56c4.png" alt="constructor"></li></ol></div> <h2 id="javascript如何实现面向对象中的继承？-百度移动"><a href="#javascript如何实现面向对象中的继承？-百度移动" class="header-anchor">#</a> JavaScript如何实现面向对象中的继承？(百度移动)</h2> <p><a href="https://www.jianshu.com/p/b76ddb68df0e" target="_blank" rel="noopener noreferrer">JS继承的几种方式:其中组合式继承有误<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>JS中没有类(es6之前),但是JS中会通过构造函数来模拟类的概念</li></ul> <ol><li>原型式继承：借用构造函数的原型对象实现继承</li></ol> <div class="danger custom-block"><p class="custom-block-title">问题</p> <ol><li>父构造函数的原型对象和子构造函数的原型对象上的成员有共享问题</li> <li>只能继承父构造函数的原型对象上的成员, 不能继承父构造函数的实例对象的成员</li></ol></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//父类</span>
<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eat</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'人可以吃东西'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//子类</span>
<span class="token keyword">function</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token parameter">score</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>score <span class="token operator">=</span> score<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 设置子构造函数的原型对象实现继承</span>
<span class="token class-name">SubClass</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token class-name">SuperClass</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>原型链继承：即 子构造函数.prototype = new 父构造函数()</li></ol> <div class="danger custom-block"><p class="custom-block-title">问题</p> <p>不能给父构造函数传递参数，父子构造函数的原型对象之间有共享问题</p></div> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">//使用继承，改变学生的原型的指向即可</span>
<span class="token keyword">function</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token parameter">score</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>score <span class="token operator">=</span> score<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 实现继承</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'小明'</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//存在问题：所有子级的name，age属性都一样</span>
<span class="token comment">// 修改子构造函数的原型的构造器属性</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Student<span class="token punctuation">;</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">study</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'学生学习'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>借用构造函数：父级构造函数名.call(当前对象, 属性, 属性...)
将要继承的父级的构造函数拿过来使用</li></ol> <div class="danger custom-block"><p class="custom-block-title">优势及缺陷</p> <ul><li>优势：解决了子类继承父类属性且值不重复的问题</li> <li>缺陷：父级原型对象上的方法不能继承</li></ul></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> score</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">Person</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>score <span class="token operator">=</span> score<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">study</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'学生学习'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">'小丽'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
stu<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//报错</span>
</code></pre></div><ol start="4"><li>组合继承： 借用构造函数 + 原型链继承</li></ol> <div class="danger custom-block"><p class="custom-block-title">优势及缺陷</p> <ul><li>优势
<ol><li>子构造函数的实例对象上能继承父构造函数上的属性,
并且能继承父构造函数原型对象上的属性和方法</li> <li>解决了给父构造函数传递参数问题</li></ol></li> <li>缺陷：
<ol><li>共享的问题</li> <li>父类的构造函数多执行一次(Student.prototype = new Person()😉</li></ol></li></ul></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 创建子构造函数</span>
<span class="token keyword">function</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> score</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">Person</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>score <span class="token operator">=</span> score<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">study</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'学生学习'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 设置继承</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Student<span class="token punctuation">;</span>
<span class="token keyword">var</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">'小丽'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
stu<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="5"><li>组合继承优化(寄生组合继承) : 借用构造函数 + 原型式继承</li></ol> <div class="danger custom-block"><p class="custom-block-title">优势</p> <ul><li>优势
<ol><li>子构造函数的实例对象上能继承父构造函数上的属性,
并且能继承父构造函数原型对象上的属性和方法</li> <li>解决了给父构造函数传递参数问题</li> <li>父类的构造函数不多执行一次</li></ol></li></ul></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> score</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">Person</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>score <span class="token operator">=</span> score<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">study</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'学生学习'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 设置继承</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//下面的方式更好，能继承父类上的静态方法</span>
<span class="token comment">//Object.setPrototypeOf(Student,Person);</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Student<span class="token punctuation">;</span>
<span class="token keyword">var</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">'小丽'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
stu<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h2 id="函数声明及函数表达式"><a href="#函数声明及函数表达式" class="header-anchor">#</a> 函数声明及函数表达式</h2> <ul><li>区分函数声明和函数表达式的最简单的方法就是看function关键字出现在声明中的位置。如果function是声明中的第一个词，那么就是一个函数声明，否则就是一个函数表达式</li> <li>匿名函数叫做匿名函数表达式</li> <li>立即执行函数叫做立即执行函数表达式 (function(){..})() 等价于 (function(){..}()), 使用哪种全凭个人喜好</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>

<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//foo函数只能在这被访问到，外部（全局）无法被访问</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> <span class="token function-variable function">goo</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment">//函数表达式，声明的foo是无意义的</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>goo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//打印函数</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//foo is not defined</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//打印函数</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//b is not defined</span>
</code></pre></div><hr> <h2 id="为什么在javascript中0-1-0-2不等于0-3？"><a href="#为什么在javascript中0-1-0-2不等于0-3？" class="header-anchor">#</a> 为什么在JavaScript中0.1+0.2不等于0.3？</h2> <p><a href="https://www.sohu.com/a/254865340_796914" target="_blank" rel="noopener noreferrer">0.1 + 0.2不等于0.3？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://www.jianshu.com/p/77f8130fd278" target="_blank" rel="noopener noreferrer">JS 数据精度以及数字格式化<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br>
0.1+0.2不等于0.3？是不是有点颠覆你的认知，但是，在js中，是真实存在的！</p> <blockquote><p>console.log(0.1+0.2);  // 0.30000000000000004
其实这都是因为浮点数运算的精度问题。<br>
简单来说，因为计算机只认识二进制，在进行运算时，需要将其他进制的数值转换成二进制，然后再进行计算。</p></blockquote> <div class="tip custom-block"><p class="custom-block-title">乘2取整</p> <div class="language-js extra-class"><pre class="language-js"><code>小数转二进制使用“乘<span class="token number">2</span>取整”的方法：
<span class="token number">0.1</span>转二进制过程如下：
<span class="token number">0.1</span><span class="token operator">*</span><span class="token number">2</span> <span class="token operator">=</span> <span class="token number">0.2</span> 取整数位<span class="token number">0</span>
<span class="token number">0.2</span><span class="token operator">*</span><span class="token number">2</span> <span class="token operator">=</span> <span class="token number">0.4</span> 取整数位<span class="token number">0</span>
<span class="token number">0.4</span><span class="token operator">*</span><span class="token number">2</span> <span class="token operator">=</span> <span class="token number">0.8</span> 取整数位<span class="token number">0</span>
<span class="token number">0.8</span><span class="token operator">*</span><span class="token number">2</span> <span class="token operator">=</span> <span class="token number">1.6</span> 取整数位<span class="token number">1</span>
<span class="token number">0.6</span><span class="token operator">*</span><span class="token number">2</span> <span class="token operator">=</span> <span class="token number">1.2</span> 取整数位<span class="token number">1</span>
<span class="token number">0.2</span><span class="token operator">*</span><span class="token number">2</span> <span class="token operator">=</span> <span class="token number">0.4</span> 取整数位<span class="token number">0</span>
<span class="token number">0.4</span><span class="token operator">*</span><span class="token number">2</span> <span class="token operator">=</span> <span class="token number">0.8</span> 取整数位<span class="token number">0</span>
<span class="token operator">...</span>
结果位<span class="token number">0.00011001100</span><span class="token operator">...</span>
</code></pre></div></div> <p>由于浮点数用二进制表达时是无穷的：<br>
// 将0.1转换成二进制</p> <blockquote><p>console.log(0.1.toString(2)); // 0.0001100110011001100110011001100110011001100110011001101<br>
// 将0.2转换成二进制<br>
console.log(0.2.toString(2));  // 0.001100110011001100110011001100110011001100110011001101</p></blockquote> <p>IEEE 754 标准的 64 位双精度浮点数的小数部分最多支持53位二进制位，所以两者相加后，因浮点数小数位的限制而截断的二进制数字，再转换为十进制，就成了 0.30000000000000004，所以在进行算术计算时会产生误差。</p> <div class="tip custom-block"><p class="custom-block-title">结构</p> <p>64位比特又可分为三个部分：</p> <blockquote><p>符号位S：第 1 位是正负数符号位（sign），0代表正数，1代表负数
指数位E：中间的 11 位存储指数（exponent），用来表示次方数
尾数位M：最后的 52 位是尾数（mantissa），超出的部分自动进一舍零</p></blockquote> <p>既然说到这里，再给大家科普一个小知识点：js最大安全数是Number.MAX_SAFE_INTEGER == Math.pow(2,53) - 1, 而不是Math.pow(2,52) - 1, why？尾数部分不是只有52位吗?</p> <p>这是因为二进制表示有效数字总是1.xx…xx的形式，尾数部分f在规约形式下第一位默认为1（省略不写，xx..xx为尾数部分f，最长52位）。因此，JS提供的有效数字最长为53个二进制位（64位浮点的后52位+被省略的1位）<br>
Math.pow(2,53) =&gt; 9007199254740992
Math.pow(2,53) + 1 =&gt; 9007199254740992</p></div> <p>所以实际上，这里错误的不是结论，而是比较的方法，正确的比较方法是使用JavaScript提供的最小精度 值：</p> <blockquote><p>console.log(	Math.abs(0.1	+	0.2	-	0.3)	&lt;=	Number.EPSILON);
ES6 在Number对象上面，新增一个极小的常量Number.EPSILON。<br>
Number.EPSILON实际上是 JavaScript 能够表示的最小精度。误差如果小于这个值，就可以认为已经没有意义了，即不存在误差了。</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">withinErrorMargin</span> <span class="token punctuation">(</span><span class="token parameter">left<span class="token punctuation">,</span> right</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>left <span class="token operator">-</span> right<span class="token punctuation">)</span> <span class="token operator">&lt;</span> Number<span class="token punctuation">.</span><span class="token constant">EPSILON</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span> <span class="token operator">===</span> <span class="token number">0.3</span> <span class="token comment">// false</span>
<span class="token function">withinErrorMargin</span><span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span> <span class="token comment">// true</span>

<span class="token number">1.1</span> <span class="token operator">+</span> <span class="token number">1.3</span> <span class="token operator">===</span> <span class="token number">2.4</span> <span class="token comment">// false</span>
<span class="token function">withinErrorMargin</span><span class="token punctuation">(</span><span class="token number">1.1</span> <span class="token operator">+</span> <span class="token number">1.3</span><span class="token punctuation">,</span> <span class="token number">2.4</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><hr> <h2 id="js-中null-undefined区别"><a href="#js-中null-undefined区别" class="header-anchor">#</a> <a href="https://www.cnblogs.com/qyzy1024/p/4036661.html" target="_blank" rel="noopener noreferrer">js 中null,undefined区别<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <p>null是一个表示&quot;无&quot;的对象，转为数值时为0；undefined是一个表示&quot;无&quot;的原始值，转为数值时为NaN。</p> <p>null表示&quot;没有对象&quot;，即该处不应该有值。典型用法是：</p> <ol><li>作为函数的参数，表示该函数的参数不是对象。</li> <li>作为对象原型链的终点。</li></ol> <p>undefined表示&quot;缺少值&quot;，就是此处应该有一个值，但是还没有定义。典型用法是：</p> <ol><li>变量被声明了，但没有赋值时，就等于undefined。</li> <li>调用函数时，应该提供的参数没有提供，该参数等于undefined</li> <li>对象没有赋值的属性，该属性的值为undefined。</li> <li>函数没有返回值时，默认返回undefined。</li></ol> <hr> <h2 id="懒加载和预加载"><a href="#懒加载和预加载" class="header-anchor">#</a> 懒加载和预加载</h2> <h3 id="懒加载"><a href="#懒加载" class="header-anchor">#</a> 懒加载</h3> <p>当图片进入可视区域，再去请求资源。需要监听scroll事件，在scroll事件的回调中，去判断懒加载的图片是否进入可视区域</p> <ul><li>图片进入可视区域之后请求图片资源</li> <li>减少无效资源的加载</li> <li>并发加载的资源过多会阻塞js的加载，影响网站的正常使用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//HTML部分</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
  <span class="token punctuation">.</span>iamge<span class="token operator">-</span>item<span class="token punctuation">{</span>
    <span class="token literal-property property">width</span><span class="token operator">:</span><span class="token number">40</span><span class="token operator">%</span><span class="token punctuation">;</span>
    margin<span class="token operator">-</span>right<span class="token operator">:</span><span class="token number">5</span><span class="token operator">%</span><span class="token punctuation">;</span>
    <span class="token literal-property property">display</span><span class="token operator">:</span>inline<span class="token operator">-</span>block<span class="token punctuation">;</span>
    <span class="token literal-property property">height</span><span class="token operator">:</span>400px<span class="token punctuation">;</span>  <span class="token comment">//必须指定图片高度，这样lazyload才能生效，不然所有图片都在首屏出现</span>
    <span class="token literal-property property">background</span><span class="token operator">:</span>grey<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;image-list&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">&quot;&quot;</span>  <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;image-item&quot;</span> lazyload<span class="token operator">=</span><span class="token string">&quot;true&quot;</span> data<span class="token operator">-</span>original<span class="token operator">=</span><span class="token string">&quot;http://pic26.nipic.com/20121213/6168183.png&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">&quot;&quot;</span>  <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;image-item&quot;</span> lazyload<span class="token operator">=</span><span class="token string">&quot;true&quot;</span> data<span class="token operator">-</span>original<span class="token operator">=</span><span class="token string">&quot;http://pic9.nipic.com/20121213/6168183.png&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">&quot;&quot;</span>  <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;image-item&quot;</span> lazyload<span class="token operator">=</span><span class="token string">&quot;true&quot;</span> data<span class="token operator">-</span>original<span class="token operator">=</span><span class="token string">&quot;http://pic32.nipic.com/20121213/6168183.png&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;./lazyload.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span> <span class="token comment">//原生事件懒加载</span>
  <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;zepto.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>  <span class="token comment">//使用插件</span>
  <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;zepto.lazyload.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>


<span class="token comment">//lazyload.js</span>
<span class="token keyword">var</span> viewHeight <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">lazyload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> eles <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'img[data-original][lazyload]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>eles<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> rect<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>original <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span>
    rect <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span>bottom <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> rect<span class="token punctuation">.</span>top <span class="token operator">&lt;</span> viewHeight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token operator">!</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        img<span class="token punctuation">.</span>src <span class="token operator">=</span> item<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
        img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          item<span class="token punctuation">.</span>src <span class="token operator">=</span> img<span class="token punctuation">.</span>src<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        item<span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">'data-original'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        item<span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">'lazyload'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">lazyload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//首屏的图片需要手动调用才能加载</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span>lazyload<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//其余图片通过监听scroll加载</span>


<span class="token comment">/***************************简化方案*************************/</span>
 <span class="token comment">// 获取所有的图片标签</span>
<span class="token keyword">const</span> imgs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span>
<span class="token comment">// 获取可视区域的高度</span>
<span class="token comment">// 在和现代浏览器及 IE9 以上的浏览器中，可以用 window.innerHeight 属性获取。在低版本 IE 的标准模式中，可以用 document.documentElement.clientHeight 获取，这里我们兼容两种情况</span>
<span class="token keyword">const</span> viewHeight <span class="token operator">=</span> window<span class="token punctuation">.</span>innerHeight <span class="token operator">||</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientHeight
<span class="token comment">// num用于统计当前显示到了哪一张图片，避免每次都从第一张图片开始检查是否露出</span>
<span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">function</span> <span class="token function">lazyload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span>num<span class="token punctuation">;</span> i<span class="token operator">&lt;</span>imgs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 用可视区域高度减去元素顶部距离可视区域顶部的高度</span>
        <span class="token keyword">let</span> distance <span class="token operator">=</span> viewHeight <span class="token operator">-</span> imgs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>top
        <span class="token comment">// 如果可视区域高度大于等于元素顶部距离可视区域顶部的高度，说明元素露出</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>distance <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// 给元素写入真实的src，展示图片</span>
            imgs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>src <span class="token operator">=</span> imgs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'data-original'</span><span class="token punctuation">)</span>
            <span class="token comment">// 前i张图片已经加载完毕，下次从第i+1张开始检查是否露出</span>
            num <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 监听Scroll事件</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> lazyload<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="预加载"><a href="#预加载" class="header-anchor">#</a> 预加载</h3> <ul><li>图片等静态资源在使用之前的提前请求</li> <li>资源使用时能从缓存中加载，提升用户体验</li> <li>页面展示的依赖关系维护</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//HTML部分</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>第一种方式 图片不会影响页面渲染，但是它会加载图片，等到需要使用时再从缓存中读取<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">&quot;http://pic26.nipic.com/20121213/6168183.png&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;display:none&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>第二种方式 手写preload<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;./myPreload.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>第三种方式 插件<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>


<span class="token comment">//myPreload.js</span>
<span class="token comment">//1. 使用Image对象</span>
<span class="token keyword">var</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
image<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&quot;http://pic26.nipic.com/20121213/6168183.png&quot;</span>

<span class="token comment">//2. 使用XMLHttpRequest对象</span>
<span class="token keyword">var</span> xmlhttprequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

xmlhttprequest<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://image.baidu.com/mouse.jpg&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xmlhttprequesy<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xmlhttprequest<span class="token punctuation">.</span>onreadystatechange <span class="token operator">=</span> callback<span class="token punctuation">;</span>  <span class="token comment">//监听请求完成</span>
xmlhttprequest<span class="token punctuation">.</span>onprogress <span class="token operator">=</span> progressCallback<span class="token punctuation">;</span>  <span class="token comment">//监听数据传输情况</span>

<span class="token keyword">function</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>xmlhttprequest<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> xmlhttprequest<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> reponseText <span class="token operator">=</span> xmlhttprequest<span class="token punctuation">.</span>responseText<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Request was unsuccessful&quot;</span> <span class="token operator">+</span> xmlhttprequest<span class="token punctuation">.</span>status<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">progressCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  e <span class="token operator">=</span> e <span class="token operator">||</span> event<span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>lengthComputable<span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Received &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>loaded  <span class="token operator">+</span> <span class="token string">&quot; of &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>total <span class="token operator">+</span> <span class="token string">&quot; bytes&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <h2 id="symbol属性"><a href="#symbol属性" class="header-anchor">#</a> Symbol属性</h2> <p>Symbol是ES6中引入的新类型，它是一切非字符串的对象key的集合。表示独一无二的
Symbol可以具有字符串类型的描述，但是即使描述相同，Symbol也不相等
<code>var mySymbol = Symbol(&quot;my symbol&quot;)</code></p> <p>一些标准中提到的Symbol，可以再全局的Symbol函数的属性中找到。例如：我们可以使用Symbol.iterator来自定义for...of在对象上的行为：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
o<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> v <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">next</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token literal-property property">value</span><span class="token operator">:</span>v<span class="token operator">++</span><span class="token punctuation">,</span> <span class="token literal-property property">done</span><span class="token operator">:</span> v <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> v <span class="token keyword">of</span> o<span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 0 1 2 3 ... 9</span>
<span class="token punctuation">}</span>
</code></pre></div><p>代码中我们定义了iterator之后，用for(var	v	of	o)就可以调用这个函数，然后我们可以根据函数的行为，产 生一个for…of的行为。<br>
这里我们给对象o添加了	Symbol.iterator	属性，并且按照迭代器的要求定义了一个0到10的迭代器，之后我 们就可以在for	of中愉快地使用这个o对象啦</p> <hr> <h2 id="new-操作符做了哪些事？"><a href="#new-操作符做了哪些事？" class="header-anchor">#</a> new 操作符做了哪些事？</h2> <p>new	运算接受一个构造器和一组调用参数，实际上做了几件事：</p> <ul><li>以构造器的 prototype	属性（注意与私有字段[[prototype]]的区分）为原型，创建新对象；</li> <li>将	this	和调用参数传给构造器，执行；</li> <li>如果构造器返回的是对象，则返回，否则返回第一步创建的对象。</li></ul> <hr> <h2 id="将函数当构造器执行做了哪些事？"><a href="#将函数当构造器执行做了哪些事？" class="header-anchor">#</a> 将函数当构造器执行做了哪些事？</h2> <p>函数实现[[call]]（作为函数被调用）和[[construct]]（作为构造器被调用）不总是一致的。</p> <p>我们大致可以认为，它们[[construct]]（作为构造器被调用）的执行过程如下：</p> <ul><li>以	Object.protoype	为原型创建一个新对象；</li> <li>以新对象为	this，执行函数的[[call]]；</li> <li>如果[[call]]的返回值是对象，那么，返回这个对象，否则返回第一步创建的新对象。</li></ul> <p>这样的规则造成了个有趣的现象，如果我们的构造器返回了一个新的对象，那么new创建的新对象就变成了一个构造函数之外完全无法访问的对象，这一定程度上可以实现“变量私有”。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">cls</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span>	<span class="token number">100</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">getValue</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token operator">=&gt;</span>	<span class="token keyword">this</span><span class="token punctuation">.</span>a
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span> 
<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span>	<span class="token class-name">cls</span><span class="token punctuation">;</span>   <span class="token comment">// 按构造函数执行时，this是构造函数生成的对象{a:100},返回的新对象{getValue:fn}中由于箭头函数的关系，this会绑定构造函数生成的对象{a:100}</span>
o<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//100    this指向 {a:100}</span>
o<span class="token punctuation">.</span>a  <span class="token comment">//a在外⾯永远⽆法访问到</span>
<span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token function">cls</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 按照普通函数执行时，this指向window{a:100}，因此返回的对象{getValue:fn}中由于箭头函数的缘故，this指向window</span>
f<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//100   //  this指向window</span>
f<span class="token punctuation">.</span>a<span class="token punctuation">;</span> <span class="token comment">// undifined</span>
</code></pre></div><div class="danger custom-block"><p class="custom-block-title">核心</p> <p>私有化变量的核心在于返回的箭头函数，因为箭头函数没有自己的this,只能接收外部的this,因此箭头函数中的this是cls中产生的this对象，相当于闭包的概念</p></div> <hr> <h2 id="箭头函数的this指向问题-实现私有变量"><a href="#箭头函数的this指向问题-实现私有变量" class="header-anchor">#</a> 箭头函数的this指向问题(实现私有变量)</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">cls</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">getValue</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>a
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">cls</span><span class="token punctuation">;</span>
o<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 100</span>
o<span class="token punctuation">.</span>a<span class="token punctuation">;</span>           <span class="token comment">// undefined</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token literal-property property">getValue</span><span class="token operator">:</span>o<span class="token punctuation">.</span>getValue<span class="token punctuation">}</span><span class="token punctuation">;</span>
b<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 100</span>

<span class="token keyword">function</span> <span class="token function">cls</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">getValue</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">cls</span><span class="token punctuation">;</span>
o<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// undefined</span>
o<span class="token punctuation">.</span>a<span class="token punctuation">;</span>           <span class="token comment">// undefined</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token literal-property property">getValue</span><span class="token operator">:</span>o<span class="token punctuation">.</span>getValue<span class="token punctuation">}</span><span class="token punctuation">;</span>
b<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 111</span>

</code></pre></div><p>关于this，Kyle	Simpson有四条总结：</p> <ol><li>由new调用的,绑定到新创建的对象。</li> <li>由call或者apply(或者bind)调用的绑定到指定的对象。</li> <li>由上下文对象调用的绑定到那个上下文对象。</li> <li>默认:在严格模式下绑定到undefined，否则绑定到全局对象
例外：箭头函数不适用以上四条规则，它会继承外层函数调用的	this	绑定(无论	this	绑定到什么)。</li></ol> <hr> <h2 id="不使用new运算符，尽可能找到获得对象的方法。"><a href="#不使用new运算符，尽可能找到获得对象的方法。" class="header-anchor">#</a> 不使用new运算符，尽可能找到获得对象的方法。</h2> <ol><li>利用字面量</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">var</span>	a	<span class="token operator">=</span>	<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>	b	<span class="token operator">=</span>	<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>	c	<span class="token operator">=</span>	<span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">abc</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token function-variable function">d</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>利用dom	api</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">var</span>	d	<span class="token operator">=</span>	document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>\
</code></pre></div><ol start="3"><li>利用JavaScript内置对象的api</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">var</span>	e	<span class="token operator">=</span>	Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">var</span>	f	<span class="token operator">=</span>	Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">k1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>	<span class="token literal-property property">k2</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">}</span><span class="token punctuation">,</span>	<span class="token punctuation">{</span><span class="token literal-property property">k3</span><span class="token operator">:</span>	<span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">var</span>	g	<span class="token operator">=</span>	<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">'{}'</span><span class="token punctuation">)</span>
</code></pre></div><ol start="4"><li>利用装箱转换</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">var</span>	h	<span class="token operator">=</span>	<span class="token function">Object</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">,</span>	i	<span class="token operator">=</span>	<span class="token function">Object</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>	k	<span class="token operator">=</span>	<span class="token function">Object</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>	l	<span class="token operator">=</span>	<span class="token function">Object</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>	m	<span class="token operator">=</span>	<span class="token function">Object</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre></div><hr> <h2 id="遍历html节点-输出标签名字"><a href="#遍历html节点-输出标签名字" class="header-anchor">#</a> 遍历HTML节点,输出标签名字</h2> <div class="tip custom-block"><p class="custom-block-title">说明</p> <ol><li>childNodes会返回节点的所有子节点，包括元素节点，文本节点，属性节点，而children只返回元素节点</li> <li>NodeName在所有节点上都有，而tagName只在元素节点上有
<img src="/assets/img/nodeName.51fe0a09.png" alt="nodeName.png"></li></ol></div> <ol><li>深度优先</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> str1 <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">deepLoopTagNode</span><span class="token punctuation">(</span><span class="token parameter">parentNode</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//parentNode.tagName &amp;&amp; console.log(parentNode.tagName)</span>
  parentNode<span class="token punctuation">.</span>tagName <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>str1 <span class="token operator">+=</span> parentNode<span class="token punctuation">.</span>tagName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  onst childNodes <span class="token operator">=</span> parentNode<span class="token punctuation">.</span>childNodes<span class="token punctuation">;</span>  <span class="token comment">//childNodes返回所有子节点包括元素节点，文本节点，属性节点</span>
  <span class="token comment">//可以使用children</span>
  <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>childNodes<span class="token punctuation">,</span> <span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>tagName<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">itemNode</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token function">deepLoopTagNode</span><span class="token punctuation">(</span>itemNode<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> str2 <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">deepLoopTagNode1</span><span class="token punctuation">(</span><span class="token parameter">parentNode</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  parentNode<span class="token punctuation">.</span>tagName <span class="token operator">&amp;&amp;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>parentNode<span class="token punctuation">.</span>tagName<span class="token punctuation">)</span>
  parentNode<span class="token punctuation">.</span>tagName <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>str2 <span class="token operator">+=</span> parentNode<span class="token punctuation">.</span>tagName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> childNodes <span class="token operator">=</span> parentNode<span class="token punctuation">.</span>children<span class="token punctuation">;</span>  <span class="token comment">//childNodes返回所有子节点包括元素节点，文本节点，属性节点</span>
  <span class="token comment">//可以使用children</span>
  rray<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>childNodes<span class="token punctuation">,</span> <span class="token parameter">itemNode</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token function">deepLoopTagNode1</span><span class="token punctuation">(</span>itemNode<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">deepLogTagNames</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span>
<span class="token function">deepLogTagNames1</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span>

</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 简化版本</span>
<span class="token keyword">function</span> <span class="token function">dfsDom</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> childNodes <span class="token operator">=</span> node<span class="token punctuation">.</span>childNodes
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> childNodes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> childNode <span class="token operator">=</span> childNodes<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>childNode<span class="token punctuation">.</span>nodeName<span class="token punctuation">)</span>
        childNode<span class="token punctuation">.</span>childNodes <span class="token operator">&amp;&amp;</span> <span class="token function">dfsDom</span><span class="token punctuation">(</span>childNode<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> root <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement
<span class="token function">dfsDom</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>广度优先</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">breadLogTagNames</span><span class="token punctuation">(</span><span class="token parameter">root</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> queue <span class="token operator">=</span> <span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span>queue<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> currentNode <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>childNodes<span class="token punctuation">,</span> tagName<span class="token punctuation">}</span> <span class="token operator">=</span> currentNode<span class="token punctuation">;</span>
    tagName <span class="token operator">&amp;&amp;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>currentNode<span class="token punctuation">.</span>tagName<span class="token punctuation">)</span> 
    <span class="token comment">// 过滤没有 tagName 的节点 ,遍历子节点然后将这一层级的所有点插入队列中处理</span>
    <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>childNodes<span class="token punctuation">,</span> <span class="token parameter">item</span><span class="token operator">=&gt;</span>item<span class="token punctuation">.</span>tagName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">itemNode</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span> queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>itemNode<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">breadLogTagNames</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span> 
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 简化版本</span>
<span class="token keyword">function</span> <span class="token function">bfsDom</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> queue <span class="token operator">=</span> <span class="token punctuation">[</span>node<span class="token punctuation">]</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>queue<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> node <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>nodeName<span class="token punctuation">)</span>
        node<span class="token punctuation">.</span>childNodes <span class="token operator">&amp;&amp;</span> queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span>node<span class="token punctuation">.</span>childNodes<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> root <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement
<span class="token function">bfsDom</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>
</code></pre></div><ol start="3"><li>TreeWalk版本</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getChildTagNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
  <span class="token keyword">const</span> walker <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createTreeWalker</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">,</span> NodeFilter<span class="token punctuation">.</span><span class="token constant">SHOW_ELEMENT</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> node<span class="token punctuation">;</span> 
  <span class="token keyword">while</span><span class="token punctuation">(</span>node <span class="token operator">=</span> walker<span class="token punctuation">.</span><span class="token function">nextNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
    <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>tagName<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>tagName<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span> 
<span class="token function">getChildTagNames</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><hr> <h2 id="for-in用于对象，for-of用于数组，那么有没有方法让对象可以使用for-of语句-symbol-iterator"><a href="#for-in用于对象，for-of用于数组，那么有没有方法让对象可以使用for-of语句-symbol-iterator" class="header-anchor">#</a> for in用于对象，for of用于数组，那么有没有方法让对象可以使用for of语句[Symbol.iterator]?</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1.</span> 数据结构默认的Iterator接口
<span class="token comment">//方法一</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">//等同于 () =&gt; ({返回对象的内容})</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">_value</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_value <span class="token operator">&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">done</span><span class="token operator">:</span><span class="token boolean">true</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">value</span><span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>_value<span class="token operator">++</span><span class="token punctuation">,</span>
            <span class="token literal-property property">done</span><span class="token operator">:</span><span class="token boolean">false</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> e <span class="token keyword">of</span> obj<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment">// 0,1,2,3,4</span>
<span class="token punctuation">[</span><span class="token operator">...</span>obj<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//[0,1,2,3,4]</span>
<span class="token keyword">let</span> iterator <span class="token operator">=</span> obj<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// {value: 0, done: false}</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// {value: 1, done: false}</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// {value: 2, done: false}</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// {value: 3, done: false}</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// {value: 4, done: false}</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// {done: true}</span>

<span class="token comment">//方法二</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> val <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token function">next</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">&gt;=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token literal-property property">value</span><span class="token operator">:</span> val<span class="token operator">++</span><span class="token punctuation">,</span><span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>使用generator函数</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">yield</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> val <span class="token keyword">of</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token operator">...</span>obj<span class="token punctuation">]</span><span class="token punctuation">;</span>  

<span class="token comment">//遍历对象的值</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'zhangsan'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">,</span>
  <span class="token literal-property property">sex</span><span class="token operator">:</span><span class="token string">'man'</span>
<span class="token punctuation">}</span>
obj<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">yield</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/**************优化写法****************/</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'haha'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">,</span>
  <span class="token literal-property property">sex</span><span class="token operator">:</span><span class="token string">'男'</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">yield</span> <span class="token keyword">this</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> value <span class="token keyword">of</span> obj<span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//zhangsan 18 man</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>obj<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//[&quot;zhangsan&quot;, 18, &quot;man&quot;]</span>

<span class="token comment">//异步for await of</span>
<span class="token keyword">function</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token parameter">duration</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//setTimeout(()=&gt;{resolve()},duration)  下面的代码更简洁</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span>duration<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">yield</span> i<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span> <span class="token keyword">await</span><span class="token punctuation">(</span><span class="token keyword">let</span> e <span class="token keyword">of</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//每隔1s打印0,1,2...9</span>
<span class="token punctuation">}</span>

<span class="token comment">/******************简化代码*********************/</span>
<span class="token keyword">async</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
 <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> i<span class="token operator">++</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre></div><hr> <h2 id="为什么javascript里面typeof-null-的值是-object-？"><a href="#为什么javascript里面typeof-null-的值是-object-？" class="header-anchor">#</a> 为什么JavaScript里面typeof(null)的值是&quot;object&quot;？</h2> <p>在JavaScript中，typeof null是'object'，它不正确地表明null是一个对象，这是一个错误，不幸的是无法修复，因为它会破坏现有的代码。我们来探讨这个bug的历史。<br>
“typeof null”错误是JavaScript第一个版本的补遗。在这个版本中，值以32位为单位存储，其中包含一个小型标记（1-3位）和实际的数据值。类型标签存储在单元的低位中。其中有五个：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">*</span><span class="token punctuation">.</span> <span class="token number">000</span>：object        数据是对对象的引用。
<span class="token operator">*</span><span class="token punctuation">.</span> <span class="token number">1</span>：int        数据是一个<span class="token number">31</span>位有符号整数。
<span class="token operator">*</span><span class="token punctuation">.</span> <span class="token number">010</span>：double        数据是对双浮点数的引用。
<span class="token operator">*</span><span class="token punctuation">.</span> <span class="token number">100</span>：string        数据是对字符串的引用。
<span class="token operator">*</span><span class="token punctuation">.</span> <span class="token number">110</span>：boolean        数据是一个布尔值。
</code></pre></div><p>也就是说，最低位是一个，然后类型标签只有一个位长。或者它是零，那么类型标签的长度是三位，为四种类型提供两个附加位。</p> <p>两个值是特殊的：</p> <ol><li>未定义undefined（JSVAL_VOID）是负的 2 的 30 次方（超出当时整型取值范围的一个数）</li> <li>null（JSVAL_NULL）是<font color="red">机器码空指针</font>。或者：<font color="red">一个对象类型标记加上一个为零的引用</font>。
显而易见，null 的存储单元最后三位和 object 一样是 000。然后让我们再看一下 typeof 的 实现 ：</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token constant">JS_PUBLIC_API</span><span class="token punctuation">(</span>JSType<span class="token punctuation">)</span>
    <span class="token function">JS_TypeOfValue</span><span class="token punctuation">(</span><span class="token parameter">JSContext <span class="token operator">*</span>cx<span class="token punctuation">,</span> jsval v</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        JSType type <span class="token operator">=</span> <span class="token constant">JSTYPE_VOID</span><span class="token punctuation">;</span>
        JSObject <span class="token operator">*</span>obj<span class="token punctuation">;</span>
        JSObjectOps <span class="token operator">*</span>ops<span class="token punctuation">;</span>
        JSClass <span class="token operator">*</span>clasp<span class="token punctuation">;</span>
        <span class="token constant">CHECK_REQUEST</span><span class="token punctuation">(</span>cx<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">JSVAL_IS_VOID</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// (1)</span>
            type <span class="token operator">=</span> <span class="token constant">JSTYPE_VOID</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">JSVAL_IS_OBJECT</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// (2)</span>
            obj <span class="token operator">=</span> <span class="token constant">JSVAL_TO_OBJECT</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">&amp;&amp;</span>
                <span class="token punctuation">(</span>ops <span class="token operator">=</span> obj<span class="token operator">-</span><span class="token operator">&gt;</span>map<span class="token operator">-</span><span class="token operator">&gt;</span>ops<span class="token punctuation">,</span>
                 ops <span class="token operator">==</span> <span class="token operator">&amp;</span>js_ObjectOps
                 <span class="token operator">?</span> <span class="token punctuation">(</span>clasp <span class="token operator">=</span> <span class="token constant">OBJ_GET_CLASS</span><span class="token punctuation">(</span>cx<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    clasp<span class="token operator">-</span><span class="token operator">&gt;</span>call <span class="token operator">||</span> clasp <span class="token operator">==</span> <span class="token operator">&amp;</span>js_FunctionClass<span class="token punctuation">)</span> <span class="token comment">// (3,4)</span>
                 <span class="token operator">:</span> ops<span class="token operator">-</span><span class="token operator">&gt;</span>call <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// (3)</span>
                type <span class="token operator">=</span> <span class="token constant">JSTYPE_FUNCTION</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                type <span class="token operator">=</span> <span class="token constant">JSTYPE_OBJECT</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">JSVAL_IS_NUMBER</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            type <span class="token operator">=</span> <span class="token constant">JSTYPE_NUMBER</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">JSVAL_IS_STRING</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            type <span class="token operator">=</span> <span class="token constant">JSTYPE_STRING</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">JSVAL_IS_BOOLEAN</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            type <span class="token operator">=</span> <span class="token constant">JSTYPE_BOOLEAN</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> type<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>代码的大致执行步骤：</p> <ul><li>在步骤（1）判断值 v 是否为 undefined(VOID)，这个检查通过下面的比较来判断：</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  #define <span class="token constant">JSVAL_IS_VOID</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>  <span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">JSVAL_VOID</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>接下来，在步骤（2）判断值是否包含 object 标志，并且通过（3）判断值是否可以调用，或者（4）判断值是否在属性 [[Class]] 中被标记为函数，来判断值为函数，否则为对象。</li> <li>接下来的步骤，依次判断是否为 number、 string 和 boolean 。在步骤（2）中 null 会被判断为 object，其实避免这个 bug 的方式很简单，在步骤（2）之前显示的检查值是否为 null . 这可以由以下C宏执行。：</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  #define <span class="token constant">JSVAL_IS_NULL</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>  <span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">JSVAL_NULL</span><span class="token punctuation">)</span>
</code></pre></div><hr> <h2 id="instanceof能否判断基本数据类型？"><a href="#instanceof能否判断基本数据类型？" class="header-anchor">#</a> instanceof能否判断基本数据类型？</h2> <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol/hasInstance" target="_blank" rel="noopener noreferrer">MDN上关于hasInstance的解释<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>instanceof的原理是基于原型链的查询，只要处于原型链中，判断永远为true; instanceof默认是无法判断基本数据类型的。但是我们可以通过改写Symbol.hasInstance属性来定义instanceof的行为</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//其实就是自定义instanceof行为的一种方式，</span>
<span class="token comment">//这里将原有的instanceof方法重定义，换成了typeof，因此能够判断基本数据类型。</span>
<span class="token keyword">class</span> <span class="token class-name">PrimitiveNumber</span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">'number'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">111</span> <span class="token keyword">instanceof</span> <span class="token class-name">PrimitiveNumber</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
</code></pre></div><hr> <h2 id="能不能手动实现instanceof的功能？"><a href="#能不能手动实现instanceof的功能？" class="header-anchor">#</a> 能不能手动实现instanceof的功能？</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">myInstanceof</span><span class="token punctuation">(</span><span class="token parameter">left<span class="token punctuation">,</span>right</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">//基本数据类型直接返回false</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> left <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span> left <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token comment">//getPrototypeOf是Object对象自带的方法，返回原型对象</span>
  <span class="token keyword">let</span> proto <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//查找到尽头还没找到</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>proto <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token comment">//找到相同的原型对象</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>proto <span class="token operator">==</span> right<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    proto <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>proto<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//测试</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">myInstanceof</span><span class="token punctuation">(</span><span class="token string">&quot;111&quot;</span><span class="token punctuation">,</span> String<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">myInstanceof</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;111&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> String<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>
</code></pre></div><hr> <h2 id="和-有什么区别？"><a href="#和-有什么区别？" class="header-anchor">#</a> '==' 和 '===' 有什么区别？</h2> <div class="tip custom-block"><p class="custom-block-title">说明</p> <p>===叫做严格相等，是指：左右两边不仅值要相等，类型也要相等，例如'1'===1的结果是false，因为一边是string，另一边是number。<br>
'=='不像'==='那样严格，对于一般情况，只要值相等，就返回true，但==还涉及一些类型转换，它的转换规则如下：</p> <ul><li>两边的类型是否相同，相同的话就比较值的大小，例如1==2，返回false</li> <li>判断的是否是null和undefined，是的话就返回true</li> <li>判断的类型是否是String和Number，是的话，把String类型转换成Number，再进行比较</li> <li>判断其中一方是否是Boolean，是的话就把Boolean转换成Number，再进行比较</li> <li>如果其中一方为Object，且另一方为String、Number或者Symbol，会将Object转换成字符串，再进行比较</li></ul></div> <hr> <h2 id="对象转原始类型是根据什么流程运行的"><a href="#对象转原始类型是根据什么流程运行的" class="header-anchor">#</a> 对象转原始类型是根据什么流程运行的?</h2> <p>对象转原始类型，会调用内置的<font color="red">[ToPrimitive]</font>函数，对于该函数而言，其逻辑如下：</p> <ol><li>如果Symbol.toPrimitive()方法，优先调用再返回</li> <li>调用valueOf()，如果转换为原始类型，则返回</li> <li>调用toString()，如果转换为原始类型，则返回</li> <li>如果都没有返回原始类型，会报错</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">4</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'5'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toPrimitive<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">6</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出7</span>
</code></pre></div><hr> <h2 id="如何让if-a-1-a-2-条件成立？"><a href="#如何让if-a-1-a-2-条件成立？" class="header-anchor">#</a> 如何让if(a == 1 &amp;&amp; a == 2)条件成立？</h2> <p>其实就是对象转原始值的应用:[Symbol.toPrimitive] valueOf() toString()三种方法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toPrimitive<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>

</code></pre></div><hr> <h2 id="不同类型比较的规则"><a href="#不同类型比较的规则" class="header-anchor">#</a> ==不同类型比较的规则</h2> <p>类型不同的变量比较时==运算只有三条规则：</p> <ol><li>undefined与null相等；</li> <li>字符串和boolean都转为数字再比较；</li> <li>对象转换成primitive类型再比较。</li></ol> <p>这样我们就可以理解一些不太符合直觉的例子了，比如：</p> <ul><li>false	==	'0'	            //true    boolean vs string</li> <li>true	==	'true'	          //false   boolean vs string</li> <li>[]	==	0	                  //true</li> <li>[]	==	false	              //true</li> <li>[]	==	null/undefined	              // false/false</li> <li>var a = {},a == null/undefined/[]  // false/false/false</li> <li>new	Boolean('false')	==	false	  //false</li> <li>new	Boolean(false)	==	false     // true</li></ul> <p>原始类型primitive type(5种):</p> <ol><li>number 数字(不分整型或浮点型)</li> <li>string 字符串</li> <li>boolean 布尔</li> <li>null 对象类型的占位符, 人为赋值null(系统不会自动赋值null)</li> <li>undefined 未定义, null衍生类型(变量没有初始化,系统自动赋值undefined)</li></ol> <p>这里不太符合直觉的有两点：
一个是即使字符串与boolean比较，也都要转换成数字；<br>
二是对象如果转换成了primitive类型跟等号另一边类型恰好相同，则不需要转换成数字。</p> <p>此外，<font color="red">==	的行为</font>也经常跟<font color="red">if的行为（转换为boolean）</font>混淆。<br>
if判断中[] {}都会判定为真，而null undefined 0 false都会判定为假</p> <hr> <hr> <h2 id="object-is和-的区别？"><a href="#object-is和-的区别？" class="header-anchor">#</a> Object.is和===的区别？</h2> <ol><li>===(严格等于)不会将数据类型进行转换，但是在判断+0 === -0(true) 和NaN === NaN(false)上会有问题</li> <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/is" target="_blank" rel="noopener noreferrer">Object.is<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>方法判断两个参数是否相同. 它在===(严格等于)的基础上修复了一些特殊情况下的失误，具体来说就是+0和-0，NaN和NaN。 源码如下：</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">is</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">===</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//运行到1/x === 1/y的时候x和y都为0，但是1/+0 = +Infinity， 1/-0 = -Infinity, 是不一样的</span>
    <span class="token keyword">return</span> x <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">||</span> y <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token number">1</span> <span class="token operator">/</span> x <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">/</span> y<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">//NaN===NaN是false,这是不对的，我们在这里做一个拦截，x !== x，那么一定是 NaN, y 同理</span>
    <span class="token comment">//两个都是NaN的时候返回true</span>
    <span class="token keyword">return</span> x <span class="token operator">!==</span> x <span class="token operator">&amp;&amp;</span> y <span class="token operator">!==</span> y<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><hr> <h2 id="为啥1-tostring-、-tostring-会报错"><a href="#为啥1-tostring-、-tostring-会报错" class="header-anchor">#</a> 为啥1.toString 、 {}.toString()会报错?</h2> <p><a href="https://segmentfault.com/q/1010000013373775" target="_blank" rel="noopener noreferrer">为啥{}.toString()会报错<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <a href="https://www.cnblogs.com/stella1024/p/10573109.html" target="_blank" rel="noopener noreferrer">js中数字直接点方法会报错<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br>
js 引擎在执行时，遇到 { 至少有两种选择:</p> <ol><li>当做语句块的开始</li> <li>当做对象字面量表达式的开始<br>
但是，默认情况下，是当做语句块的，所以{}.toString()会报错：<font color="red">Unexpected token .</font>, 因为实际上浏览器执行的可能是这样：</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token comment">//空语句块</span>
<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//另外一条错误的语句</span>
</code></pre></div><p>如果要让 js 引擎认为 { 是一个对象字面量表达式的开始，一般就是加 ()，这个时候，js 引擎就知道()里的是表达式，所以当做表达式来解析，所以({}).toString()就不会报错;<br>
[].toString()不报错，很正常，因为这里没有歧义，肯定是数组字面量表达式</p> <p>1.toString()报错原因：<br>
JavaScript的解释器把数字后的&quot;.&quot;偷走了（作为前面数字的小数点）, 类似于下面的操作：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token number">111.</span><span class="token punctuation">)</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><hr> <h2 id="script标签异步引入外部资源，defer和async有啥区别？"><a href="#script标签异步引入外部资源，defer和async有啥区别？" class="header-anchor">#</a> script标签异步引入外部资源，defer和async有啥区别？</h2> <p>当浏览器碰到 script 脚本的时候：</p> <ol><li>常规</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;script.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p>没有 defer 或 async，浏览器会立即加载并执行指定的脚本，“立即”指的是在渲染该 script 标签之下的文档元素之前，也就是说不等待后续载入的文档元素，读到就加载并执行。<br>
2. async</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script <span class="token keyword">async</span> src<span class="token operator">=</span><span class="token string">&quot;script.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p>有 async，加载和渲染后续文档元素的过程将和 script.js 的加载与执行并行进行（异步）。<br>
3. defer</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script defer src<span class="token operator">=</span><span class="token string">&quot;myscript.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p>有 defer，加载后续文档元素的过程将和 script.js 的加载并行进行（异步），但是 script.js 的执行要在所有元素解析完成之后，DOMContentLoaded 事件触发之前完成。<br>
4. 加载多个JS脚本，async无序加载，defer有序加载
执行时机见下图:
<img src="/assets/img/script_defer_async.244a0c32.jpg" alt="script_defer_async.jpg"> <img src="/assets/img/script_defer_async2.ff9ba469.png" alt="script_defer_async2.png">
蓝色线代表网络读取，红色线代表执行时间，这俩都是针对脚本的；绿色线代表 HTML 解析。
此图告诉我们以下几个要点：</p> <ol><li>defer 和 async 在网络读取（下载）这块儿是一样的，都是异步的（相较于 HTML 解析）</li> <li>它俩的差别在于脚本下载完之后何时执行，显然 defer 是最接近我们对于应用脚本加载和执行的要求的</li> <li>关于 defer，此图未尽之处在于它是按照加载顺序执行脚本的，这一点要善加利用</li> <li>async 则是一个乱序执行的主，反正对它来说脚本的加载和执行是紧紧挨着的，所以不管你声明的顺序如何，只要它加载完了就会立刻执行</li> <li>仔细想想，async 对于应用脚本的用处不大，因为它完全不考虑依赖（哪怕是最低级的顺序执行），不过它对于那些可以不依赖任何脚本或不被任何脚本依赖的脚本来说却是非常合适的，最典型的例子：Google Analytics</li></ol> <hr> <h2 id="mouseover-mouseout和mouseenter-mouseleave的区别"><a href="#mouseover-mouseout和mouseenter-mouseleave的区别" class="header-anchor">#</a> mouseover mouseout和mouseenter mouseleave的区别</h2> <ol><li>mouseover + mouseout:成对出现，父子元素都能触发，且先于下面的事件触发</li> <li>mouseenter + mouseleave:成对出现，只在父元素触发。</li></ol> <div class="tip custom-block"><p class="custom-block-title">补充说明：</p> <p>mouseover: 只要鼠标指针移入事件所绑定的元素或其子元素，都会触发该事件<br>
mouseenter: 只有鼠标指针移入事件所绑定的元素时，才会触发该事件<br>
mouseout: 只要鼠标指针移出事件所绑定的元素或其子元素，都会触发该事件<br>
mouseleave: 只有鼠标指针移出事件所绑定的元素时，才会触发该事件</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>b<span class="token punctuation">{</span>
      <span class="token literal-property property">width</span><span class="token operator">:</span> 200px<span class="token punctuation">;</span>
      <span class="token literal-property property">height</span><span class="token operator">:</span> 200px<span class="token punctuation">;</span>
      <span class="token literal-property property">background</span><span class="token operator">:</span> beige<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span>c<span class="token punctuation">{</span>
      <span class="token literal-property property">width</span><span class="token operator">:</span> 100px<span class="token punctuation">;</span>
      <span class="token literal-property property">height</span><span class="token operator">:</span> 100px<span class="token punctuation">;</span>
      <span class="token literal-property property">background</span><span class="token operator">:</span> violet<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;b&quot;</span>
        onmouseenter<span class="token operator">=</span><span class="token string">&quot;mouseenter()&quot;</span>
        onmouseleave<span class="token operator">=</span><span class="token string">&quot;mouseleave()&quot;</span>
        onmouseout<span class="token operator">=</span><span class="token string">&quot;mouseout()&quot;</span>
        onmouseover<span class="token operator">=</span><span class="token string">&quot;mouseover()&quot;</span>
        onmousemove<span class="token operator">=</span><span class="token string">&quot;mousemove()&quot;</span><span class="token operator">&gt;</span><span class="token constant">B</span>
        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;c&quot;</span><span class="token operator">&gt;</span><span class="token constant">C</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
      <span class="token keyword">function</span> <span class="token function">mouseenter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'mouseenter'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">function</span> <span class="token function">mouseleave</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'mouseleave'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">function</span> <span class="token function">mouseout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'mouseout'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">function</span> <span class="token function">mouseover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'mouseover'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">function</span> <span class="token function">mousemove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token comment">//鼠标从B左边到右边划过依次触发：</span>
<span class="token comment">// 父mouseover -&gt; 父mouseenter -&gt; 父mousemove -&gt; 父mouseout </span>
<span class="token comment">// -&gt; 子mouseover -&gt; 子mousemove -&gt; 子mouseout -&gt; 父mouseover </span>
<span class="token comment">// -&gt; 父mousemove -&gt; 父mouseout -&gt; 父mouseleave</span>
</code></pre></div><p><img src="/assets/img/mouseaction.9d63a6de.png" alt="mouseaction.png"></p> <hr> <h2 id="js中数组扁平化"><a href="#js中数组扁平化" class="header-anchor">#</a> JS中数组扁平化</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> ary <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// -&gt; [1, 2, 3, 4, 5, 6]</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>ary<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>需求:多维数组=&gt;一维数组</p> <ol><li>调用ES6中的flat方法</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>arr <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">Infinity</span><span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>replace + split</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\[\]]</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="3"><li>replace + JSON.parse</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\[\]]</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
str <span class="token operator">=</span> <span class="token string">'['</span> <span class="token operator">+</span> str <span class="token operator">+</span> <span class="token string">']'</span><span class="token punctuation">;</span>
ary <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="4"><li>普通递归</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">ary</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ary<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> item <span class="token operator">=</span> ary<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>ary<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="5"><li>利用reduce函数迭代</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">flatten</span><span class="token punctuation">(</span><span class="token parameter">ary</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> ary<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">pre<span class="token punctuation">,</span>cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> pre<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>cur<span class="token punctuation">)</span><span class="token operator">?</span><span class="token function">flatten</span><span class="token punctuation">(</span>cur<span class="token punctuation">)</span><span class="token operator">:</span>cur<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> ary <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">flatten</span><span class="token punctuation">(</span>ary<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><ol start="6"><li>扩展运算符</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//只要有一个元素有数组，那么循环继续</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>ary<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span>isArray<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  ary <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token operator">...</span>ary<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//二维转一维，如果还有更多维，则继续迭代</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <h2 id="请用js实现ajax并发请求控制-字节跳动"><a href="#请用js实现ajax并发请求控制-字节跳动" class="header-anchor">#</a> 请用JS实现Ajax并发请求控制(字节跳动)</h2> <p>实现一个批量请求函数 multiRequest(urls, maxNum)，要求如下：</p> <ul><li>要求最大并发数 maxNum</li> <li>每当有一个请求返回，就留下一个空位，可以增加新的请求</li> <li>所有请求完成后，结果按照 urls 里面的顺序依次打出</li></ul> <div class="tip custom-block"><p class="custom-block-title">思路分析</p> <p>整体采用递归调用来实现：最初发送的请求数量上限为允许的最大值，并且这些请求中的每一个都应该在完成时继续递归发送，通过传入的索引来确定了urls里面具体是那个URL，保证最后输出的顺序不会乱，而是依次输出。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">multiRequest</span><span class="token punctuation">(</span><span class="token parameter">urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> maxNum</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 请求总数量</span>
    <span class="token keyword">const</span> len <span class="token operator">=</span> urls<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token comment">// 根据请求数量创建一个数组来保存请求的结果</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 当前完成的数量</span>
    <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 请求maxNum个</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>count <span class="token operator">&lt;</span> maxNum<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">function</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> current <span class="token operator">=</span> count<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token comment">// 处理边界条件</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>current <span class="token operator">&gt;=</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 请求全部完成就将promise置为成功状态，然后将result作为promise值返回</span>
                <span class="token operator">!</span>result<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token function">urls</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">开始 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>current<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 保存请求结果</span>
                    result<span class="token punctuation">[</span>current<span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">完成 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>current<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 请求没有全部完成，就递归</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>current <span class="token operator">&lt;</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">结束 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>current<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    result<span class="token punctuation">[</span>current<span class="token punctuation">]</span> <span class="token operator">=</span> err<span class="token punctuation">;</span>
                    <span class="token comment">// 请求没有全部完成，就递归</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>current <span class="token operator">&lt;</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <h2 id="js实现将数字转成千分位的方法小结【5种方式】"><a href="#js实现将数字转成千分位的方法小结【5种方式】" class="header-anchor">#</a> JS实现将数字转成千分位的方法小结【5种方式】</h2> <p><a href="https://www.jb51.net/article/99675.htm" target="_blank" rel="noopener noreferrer">参考链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>利用正则的零宽度正预测先行断言(?=exp);它断言自身出现的位置的后面能匹配表达式exp</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;87463297&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\d{1,3}(?=(\d{3})+$)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> s<span class="token operator">+</span><span class="token string">','</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// 考虑小数点</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;87463297.123&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\d{1,3}(?=(\d{3})+(?=\.|$))</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> s<span class="token operator">+</span><span class="token string">','</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 此时s为\d{1, 3}匹配的内容</span>
</code></pre></div><ul><li>利用正则的子项来替换</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;87463297&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(\d{1,3})(?=(\d{3})+$)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> s<span class="token operator">+</span><span class="token string">','</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(\d{1,3})(?=(\d{3})+$)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">$1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> $1<span class="token operator">=</span>$1<span class="token operator">+</span><span class="token string">','</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 此时$1和s跟上面一样,其实它们都是回调函数的参数，只是参数命名的差异；为\d{1, 3}匹配的内容.</span>

console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(\d{1,3})(?=(\d{3})+$)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token string">'$1,'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 正常！！！</span>
<span class="token comment">// 这里的$1才是整整被(\d{1,3})这个括号捕捉的匹配内容，是有特殊含义的捕获分组</span>

<span class="token comment">// 考虑小数点</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;87463297.123&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(\d{1,3})(?=(\d{3})+(?=$|\.))</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token string">'$1,'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>先将字符串转成数组，利用reverse反转数组后每3个数字后添加一个分隔符“,”，到字符串末尾除外，之后转回字符串</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 利用字符串和数组方法</span>
console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(\d{3})+?</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> s<span class="token operator">+</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">,$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
</code></pre></div><ul><li>利用while循环拼接字符串每隔3个数字加一个分隔符，首尾不加</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 利用循环拼接字符串每隔3个加一个分隔符</span>
<span class="token keyword">var</span> result<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
  len <span class="token operator">=</span> str<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">while</span><span class="token punctuation">(</span>len<span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  index<span class="token operator">%</span><span class="token number">3</span><span class="token operator">===</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>index<span class="token operator">!==</span><span class="token number">0</span> <span class="token operator">?</span> result<span class="token operator">+=</span><span class="token string">&quot;,&quot;</span><span class="token operator">+</span>str<span class="token punctuation">[</span>len<span class="token punctuation">]</span> <span class="token operator">:</span> result<span class="token operator">+=</span>str<span class="token punctuation">[</span>len<span class="token punctuation">]</span><span class="token punctuation">;</span>
  len<span class="token operator">--</span><span class="token punctuation">;</span>
  index<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
result<span class="token operator">=</span>result<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>利用while循环在数组里push分隔符，首尾不加</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 利用while循环在数组里push分隔符</span>
<span class="token keyword">var</span> result<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
  len <span class="token operator">=</span> str<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
  i <span class="token operator">=</span> len<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
  arr <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span><span class="token punctuation">(</span>len<span class="token operator">-</span>index<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  len<span class="token operator">&gt;=</span>index<span class="token operator">&amp;&amp;</span>len<span class="token operator">-</span>index<span class="token operator">!==</span>len <span class="token operator">&amp;&amp;</span> arr<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>len<span class="token operator">-</span>index<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  index<span class="token operator">+=</span><span class="token number">3</span><span class="token punctuation">;</span>
  i<span class="token operator">-=</span><span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/Interview/" class="prev router-link-active">
          页面说明
        </a></span> <span class="next"><a href="/Interview/html.html">
          HTML相关
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.28316916.js" defer></script><script src="/assets/js/2.2f6f10e7.js" defer></script>
  </body>
</html>
